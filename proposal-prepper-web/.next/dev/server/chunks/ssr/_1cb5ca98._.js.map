{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/afos/Downloads/CtrlCheck-af-nonopen/proposal-prepper-web/src/components/ui/index.ts"],"sourcesContent":["// SPDX-License-Identifier: AGPL-3.0-or-later\n// SPDX-FileCopyrightText: 2025 Seventeen Sierra LLC\n\n/**\n * UI Component Library Integration\n *\n * Centralized exports and configuration for @17sierra/ui components\n * used in the threshold functionality. Provides a consistent interface\n * for importing UI components across the application.\n */\n\n// Re-export commonly used components from @17sierra/ui\n// These will be the primary UI building blocks for threshold components\nexport {\n  Alert,\n  AlertDescription,\n  AlertTitle,\n  Avatar,\n  AvatarFallback,\n  AvatarImage,\n  Badge,\n  Button,\n  Card,\n  CardContent,\n  CardDescription,\n  CardFooter,\n  CardHeader,\n  CardTitle,\n  Dialog,\n  DialogContent,\n  DialogDescription,\n  DialogFooter,\n  DialogHeader,\n  DialogTitle,\n  DialogTrigger,\n  Input,\n  Label,\n  Progress,\n  Separator,\n  Tabs,\n  TabsContent,\n  TabsList,\n  TabsTrigger,\n  Textarea,\n  Toast,\n  Toaster,\n  useToast,\n} from '@17sierra/ui';\n\n/**\n * Theme Configuration\n *\n * Threshold-specific theme customizations and styling utilities\n * that extend the base @17sierra/ui theme.\n */\nexport const thresholdTheme = {\n  colors: {\n    // Status colors for upload and analysis states\n    upload: {\n      pending: 'hsl(var(--muted))',\n      uploading: 'hsl(var(--primary))',\n      processing: 'hsl(var(--secondary))',\n      completed: 'hsl(var(--success))',\n      failed: 'hsl(var(--destructive))',\n    },\n    analysis: {\n      queued: 'hsl(var(--muted))',\n      extracting: 'hsl(var(--primary))',\n      analyzing: 'hsl(var(--primary))',\n      validating: 'hsl(var(--secondary))',\n      completed: 'hsl(var(--success))',\n      failed: 'hsl(var(--destructive))',\n    },\n    compliance: {\n      pass: 'hsl(var(--success))',\n      warning: 'hsl(var(--warning))',\n      fail: 'hsl(var(--destructive))',\n    },\n  },\n} as const;\n\n/**\n * Component Variants\n *\n * Threshold-specific component variants that extend the base\n * @17sierra/ui component variants for consistent styling.\n */\nexport const variants = {\n  button: {\n    upload: 'bg-blue-600 hover:bg-blue-700 text-white',\n    analyze: 'bg-green-600 hover:bg-green-700 text-white',\n    results: 'bg-purple-600 hover:bg-purple-700 text-white',\n  },\n  badge: {\n    status: {\n      pending: 'bg-gray-100 text-gray-800',\n      processing: 'bg-blue-100 text-blue-800',\n      completed: 'bg-green-100 text-green-800',\n      failed: 'bg-red-100 text-red-800',\n    },\n  },\n} as const;\n"],"names":[],"mappings":"AAAA,6CAA6C;AAC7C,oDAAoD;AAEpD;;;;;;CAMC,GAED,uDAAuD;AACvD,wEAAwE;;;;;;;;AA2CjE,MAAM,iBAAiB;IAC5B,QAAQ;QACN,+CAA+C;QAC/C,QAAQ;YACN,SAAS;YACT,WAAW;YACX,YAAY;YACZ,WAAW;YACX,QAAQ;QACV;QACA,UAAU;YACR,QAAQ;YACR,YAAY;YACZ,WAAW;YACX,YAAY;YACZ,WAAW;YACX,QAAQ;QACV;QACA,YAAY;YACV,MAAM;YACN,SAAS;YACT,MAAM;QACR;IACF;AACF;AAQO,MAAM,WAAW;IACtB,QAAQ;QACN,QAAQ;QACR,SAAS;QACT,SAAS;IACX;IACA,OAAO;QACL,QAAQ;YACN,SAAS;YACT,YAAY;YACZ,WAAW;YACX,QAAQ;QACV;IACF;AACF"}},
    {"offset": {"line": 65, "column": 0}, "map": {"version":3,"sources":["file:///Users/afos/Downloads/CtrlCheck-af-nonopen/proposal-prepper-web/src/config/app.ts"],"sourcesContent":["// SPDX-License-Identifier: AGPL-3.0-or-later\n// SPDX-FileCopyrightText: 2025 Seventeen Sierra LLC\n\n/**\n * Application Configuration\n *\n * Configuration constants and settings for the Proposal Prepper application.\n * Centralizes all configurable values used across components, services, and utilities.\n */\n\n/**\n * File Upload Configuration\n *\n * Settings for file upload validation and processing.\n * Based on requirements 1.1 and 1.2 for PDF acceptance and validation.\n */\nexport const uploadConfig = {\n  /** Accepted file types (PDF only for MVP) */\n  acceptedTypes: ['application/pdf'] as const,\n  /** Maximum file size in bytes (100MB) */\n  maxFileSize: 100 * 1024 * 1024,\n  /** Minimum file size in bytes (1KB) */\n  minFileSize: 1024,\n  /** Upload chunk size for progress tracking */\n  chunkSize: 1024 * 1024, // 1MB chunks\n  /** Maximum concurrent uploads */\n  maxConcurrentUploads: 1,\n  /** Upload timeout in milliseconds */\n  uploadTimeout: 5 * 60 * 1000, // 5 minutes\n} as const;\n\n/**\n * Analysis Configuration\n *\n * Settings for compliance analysis processing.\n * Based on requirements 2.1-2.5 for FAR/DFARS validation.\n */\nexport const analysisConfig = {\n  /** Analysis timeout in milliseconds */\n  analysisTimeout: 10 * 60 * 1000, // 10 minutes\n  /** Progress update interval in milliseconds */\n  progressUpdateInterval: 1000, // 1 second\n  /** Maximum retry attempts for failed analysis */\n  maxRetryAttempts: 3,\n  /** Retry delay in milliseconds */\n  retryDelay: 5000, // 5 seconds\n  /** Supported compliance frameworks */\n  frameworks: ['FAR', 'DFARS'] as const,\n} as const;\n\n/**\n * UI Configuration\n *\n * Settings for user interface behavior and appearance.\n * Based on requirements 4.1-4.5 and 5.1-5.5 for interface functionality.\n */\nexport const uiConfig = {\n  /** Page load timeout target in milliseconds */\n  loadTimeTarget: 5000, // 5 seconds (requirement 5.1)\n  /** Navigation transition duration in milliseconds */\n  transitionDuration: 200,\n  /** Progress update frequency in milliseconds */\n  progressUpdateFrequency: 500,\n  /** Notification auto-dismiss timeout in milliseconds */\n  notificationTimeout: 5000,\n  /** Maximum notifications to display simultaneously */\n  maxNotifications: 5,\n  /** Breakpoints for responsive design */\n  breakpoints: {\n    mobile: 768,\n    tablet: 1024,\n    desktop: 1280,\n  },\n} as const;\n\n/**\n * API Configuration\n *\n * Settings for backend service communication.\n * Configured for the federated mesh architecture.\n */\nexport const apiConfig = {\n  /** Base URL for Strands service - Docker container or localhost */\n  strandsBaseUrl:\n    process.env.NEXT_PUBLIC_STRANDS_URL ||\n    process.env.STRANDS_SERVICE_URL ||\n    (typeof window === 'undefined' ? 'http://strands:8080' : ''),\n  /** Use mock APIs for development (when external services aren't available) */\n  useMockApis: process.env.NEXT_PUBLIC_USE_MOCK_APIS === 'true',\n  /** API request timeout in milliseconds */\n  requestTimeout: 30000, // 30 seconds\n  /** Maximum retry attempts for API requests */\n  maxRetries: 3,\n  /** Retry delay in milliseconds */\n  retryDelay: 1000,\n  /** WebSocket reconnection settings */\n  websocket: {\n    reconnectInterval: 5000,\n    maxReconnectAttempts: 10,\n  },\n} as const;\n\n/**\n * Validation Configuration\n *\n * Settings for input validation and sanitization.\n */\nexport const validationConfig = {\n  /** Maximum filename length */\n  maxFilenameLength: 255,\n  /** Allowed filename characters pattern */\n  filenamePattern: /^[a-zA-Z0-9._-]+$/,\n  /** Maximum session ID length */\n  maxSessionIdLength: 128,\n  /** Session ID pattern */\n  sessionIdPattern: /^[a-zA-Z0-9-]+$/,\n} as const;\n\n/**\n * Error Configuration\n *\n * Settings for error handling and recovery.\n */\nexport const errorConfig = {\n  /** Default error message for unknown errors */\n  defaultErrorMessage: 'An unexpected error occurred. Please try again.',\n  /** Error codes for specific error types */\n  codes: {\n    UPLOAD_FAILED: 'UPLOAD_001',\n    ANALYSIS_FAILED: 'ANALYSIS_001',\n    VALIDATION_FAILED: 'VALIDATION_001',\n    NETWORK_ERROR: 'NETWORK_001',\n    TIMEOUT_ERROR: 'TIMEOUT_001',\n    SERVICE_UNAVAILABLE: 'SERVICE_002',\n    SERVICE_ERROR: 'SERVICE_003',\n  },\n  /** Error recovery strategies */\n  recovery: {\n    autoRetry: true,\n    maxAutoRetries: 2,\n    retryDelay: 2000,\n  },\n} as const;\n\n/**\n * Feature Flags\n *\n * Configuration for enabling/disabling features during development\n * and deployment phases.\n */\nexport const featureFlags = {\n  /** Enable detailed logging for debugging */\n  enableDetailedLogging: process.env.NODE_ENV === 'development',\n  /** Enable performance monitoring */\n  enablePerformanceMonitoring: true,\n  /** Enable error reporting */\n  enableErrorReporting: process.env.NODE_ENV === 'production',\n  /** Enable advanced analysis features (future enhancement) */\n  enableAdvancedAnalysis: false,\n  /** Enable real-time progress updates */\n  enableRealTimeUpdates: true,\n} as const;\n"],"names":[],"mappings":"AAAA,6CAA6C;AAC7C,oDAAoD;AAEpD;;;;;CAKC,GAED;;;;;CAKC;;;;;;;;;;;;;;;;AACM,MAAM,eAAe;IAC1B,2CAA2C,GAC3C,eAAe;QAAC;KAAkB;IAClC,uCAAuC,GACvC,aAAa,MAAM,OAAO;IAC1B,qCAAqC,GACrC,aAAa;IACb,4CAA4C,GAC5C,WAAW,OAAO;IAClB,+BAA+B,GAC/B,sBAAsB;IACtB,mCAAmC,GACnC,eAAe,IAAI,KAAK;AAC1B;AAQO,MAAM,iBAAiB;IAC5B,qCAAqC,GACrC,iBAAiB,KAAK,KAAK;IAC3B,6CAA6C,GAC7C,wBAAwB;IACxB,+CAA+C,GAC/C,kBAAkB;IAClB,gCAAgC,GAChC,YAAY;IACZ,oCAAoC,GACpC,YAAY;QAAC;QAAO;KAAQ;AAC9B;AAQO,MAAM,WAAW;IACtB,6CAA6C,GAC7C,gBAAgB;IAChB,mDAAmD,GACnD,oBAAoB;IACpB,8CAA8C,GAC9C,yBAAyB;IACzB,sDAAsD,GACtD,qBAAqB;IACrB,oDAAoD,GACpD,kBAAkB;IAClB,sCAAsC,GACtC,aAAa;QACX,QAAQ;QACR,QAAQ;QACR,SAAS;IACX;AACF;AAQO,MAAM,YAAY;IACvB,iEAAiE,GACjE,gBACE,QAAQ,GAAG,CAAC,uBAAuB,IACnC,QAAQ,GAAG,CAAC,mBAAmB,IAC/B,CAAC,uCAAgC,wBAAwB,uBAAE;IAC7D,4EAA4E,GAC5E,aAAa,QAAQ,GAAG,CAAC,yBAAyB,KAAK;IACvD,wCAAwC,GACxC,gBAAgB;IAChB,4CAA4C,GAC5C,YAAY;IACZ,gCAAgC,GAChC,YAAY;IACZ,oCAAoC,GACpC,WAAW;QACT,mBAAmB;QACnB,sBAAsB;IACxB;AACF;AAOO,MAAM,mBAAmB;IAC9B,4BAA4B,GAC5B,mBAAmB;IACnB,wCAAwC,GACxC,iBAAiB;IACjB,8BAA8B,GAC9B,oBAAoB;IACpB,uBAAuB,GACvB,kBAAkB;AACpB;AAOO,MAAM,cAAc;IACzB,6CAA6C,GAC7C,qBAAqB;IACrB,yCAAyC,GACzC,OAAO;QACL,eAAe;QACf,iBAAiB;QACjB,mBAAmB;QACnB,eAAe;QACf,eAAe;QACf,qBAAqB;QACrB,eAAe;IACjB;IACA,8BAA8B,GAC9B,UAAU;QACR,WAAW;QACX,gBAAgB;QAChB,YAAY;IACd;AACF;AAQO,MAAM,eAAe;IAC1B,0CAA0C,GAC1C,uBAAuB,oDAAyB;IAChD,kCAAkC,GAClC,6BAA6B;IAC7B,2BAA2B,GAC3B,sBAAsB,oDAAyB;IAC/C,2DAA2D,GAC3D,wBAAwB;IACxB,sCAAsC,GACtC,uBAAuB;AACzB"}},
    {"offset": {"line": 170, "column": 0}, "map": {"version":3,"sources":["file:///Users/afos/Downloads/CtrlCheck-af-nonopen/proposal-prepper-web/src/types/app.ts"],"sourcesContent":["// SPDX-License-Identifier: AGPL-3.0-or-later\n// SPDX-FileCopyrightText: 2025 Seventeen Sierra LLC\n\n/**\n * Application Type Definitions\n *\n * Core TypeScript interfaces and types for the Proposal Prepper application.\n * These types define the data models used across the upload, analysis,\n * and results presentation components.\n */\n\n/**\n * Upload Session Management\n *\n * Tracks the state and progress of document upload operations.\n * Used by the Upload Manager component to provide user feedback\n * and handle upload lifecycle events.\n */\nexport interface UploadSession {\n  /** Unique identifier for the upload session */\n  id: string;\n  /** Original filename of the uploaded document */\n  filename: string;\n  /** File size in bytes */\n  fileSize: number;\n  /** MIME type of the uploaded file */\n  mimeType: string;\n  /** Current status of the upload operation */\n  status: UploadStatus;\n  /** Upload progress as percentage (0-100) */\n  progress: number;\n  /** Timestamp when upload was initiated */\n  startedAt: Date;\n  /** Timestamp when upload completed (if applicable) */\n  completedAt?: Date;\n  /** Error message if upload failed */\n  errorMessage?: string;\n  /** Analysis session ID if analysis was automatically started */\n  analysisSessionId?: string;\n}\n\n/**\n * Upload Status Enumeration\n *\n * Defines the possible states of an upload operation throughout\n * its lifecycle from initiation to completion or failure.\n */\nexport enum UploadStatus {\n  PENDING = 'pending',\n  UPLOADING = 'uploading',\n  PROCESSING = 'processing',\n  COMPLETED = 'completed',\n  FAILED = 'failed',\n}\n\n/**\n * Analysis Session Management\n *\n * Tracks the state and progress of compliance analysis operations.\n * Used by the Analysis Coordinator component to orchestrate the\n * analysis workflow and provide progress feedback.\n */\nexport interface AnalysisSession {\n  /** Unique identifier for the analysis session */\n  id: string;\n  /** Reference to the proposal being analyzed */\n  proposalId: string;\n  /** Current status of the analysis operation */\n  status: AnalysisStatus;\n  /** Analysis progress as percentage (0-100) */\n  progress: number;\n  /** Timestamp when analysis was initiated */\n  startedAt: Date;\n  /** Timestamp when analysis completed (if applicable) */\n  completedAt?: Date;\n  /** Estimated completion time (if available) */\n  estimatedCompletion?: Date;\n  /** Description of current analysis step */\n  currentStep: string;\n}\n\n/**\n * Analysis Status Enumeration\n *\n * Defines the possible states of an analysis operation throughout\n * the compliance checking workflow.\n */\nexport enum AnalysisStatus {\n  QUEUED = 'queued',\n  EXTRACTING = 'extracting',\n  ANALYZING = 'analyzing',\n  VALIDATING = 'validating',\n  COMPLETED = 'completed',\n  FAILED = 'failed',\n}\n\n/**\n * User Interface State Management\n *\n * Manages the overall state of the user interface including\n * navigation, active sessions, and user preferences.\n * Used by the Navigation Controller and UI components.\n */\nexport interface UIState {\n  /** Current view being displayed */\n  currentView: ViewType;\n  /** History of navigation for breadcrumbs and back navigation */\n  navigationHistory: string[];\n  /** Currently active upload session (if any) */\n  activeUpload?: UploadSession;\n  /** Currently active analysis session (if any) */\n  activeAnalysis?: AnalysisSession;\n  /** System notifications and messages */\n  notifications: Notification[];\n  /** User preferences and settings */\n  preferences: UserPreferences;\n}\n\n/**\n * View Type Enumeration\n *\n * Defines the different views/pages available in the application\n * for navigation and routing purposes.\n */\nexport enum ViewType {\n  DASHBOARD = 'dashboard',\n  UPLOAD = 'upload',\n  ANALYSIS = 'analysis',\n  RESULTS = 'results',\n  SETTINGS = 'settings',\n}\n\n/**\n * System Notification\n *\n * Represents user-facing notifications for system events,\n * errors, and status updates.\n */\nexport interface Notification {\n  /** Unique identifier for the notification */\n  id: string;\n  /** Notification type for styling and behavior */\n  type: NotificationType;\n  /** Main notification message */\n  message: string;\n  /** Optional detailed description */\n  description?: string;\n  /** Timestamp when notification was created */\n  timestamp: Date;\n  /** Whether notification has been read by user */\n  read: boolean;\n  /** Auto-dismiss timeout in milliseconds (if applicable) */\n  timeout?: number;\n}\n\n/**\n * Notification Type Enumeration\n *\n * Defines the different types of notifications for appropriate\n * styling and user interaction patterns.\n */\nexport enum NotificationType {\n  INFO = 'info',\n  SUCCESS = 'success',\n  WARNING = 'warning',\n  ERROR = 'error',\n}\n\n/**\n * Issue Severity Enumeration\n *\n * Defines the severity levels for compliance issues found during analysis.\n * Used across analysis, validation, and results components.\n */\nexport enum IssueSeverity {\n  CRITICAL = 'critical',\n  WARNING = 'warning',\n  INFO = 'info',\n}\n\n/**\n * User Preferences\n *\n * Stores user-configurable settings and preferences for\n * personalizing the application experience.\n */\nexport interface UserPreferences {\n  /** Preferred theme (light/dark) */\n  theme: 'light' | 'dark' | 'system';\n  /** Whether to show detailed progress information */\n  showDetailedProgress: boolean;\n  /** Whether to auto-dismiss success notifications */\n  autoDismissNotifications: boolean;\n  /** Preferred notification timeout in milliseconds */\n  notificationTimeout: number;\n  /** Whether to show advanced analysis options */\n  showAdvancedOptions: boolean;\n}\n"],"names":[],"mappings":"AAAA,6CAA6C;AAC7C,oDAAoD;AAEpD;;;;;;CAMC,GAED;;;;;;CAMC;;;;;;;;;;;;AA8BM,IAAA,AAAK,sCAAA;;;;;;WAAA;;AAwCL,IAAA,AAAK,wCAAA;;;;;;;WAAA;;AAqCL,IAAA,AAAK,kCAAA;;;;;;WAAA;;AAqCL,IAAA,AAAK,0CAAA;;;;;WAAA;;AAaL,IAAA,AAAK,uCAAA;;;;WAAA"}},
    {"offset": {"line": 238, "column": 0}, "map": {"version":3,"sources":["file:///Users/afos/Downloads/CtrlCheck-af-nonopen/proposal-prepper-web/src/utils/performance.ts"],"sourcesContent":["/*\n * SPDX-License-Identifier: AGPL-3.0-or-later\n * SPDX-FileCopyrightText: 2025 Seventeen Sierra LLC\n */\n\n/**\n * Performance Utilities\n *\n * Implements caching strategies and performance optimizations\n * for the Proposal Prepper application.\n *\n * Requirement 5.1: Load time performance optimization\n */\n\n/**\n * Simple in-memory cache with TTL support\n */\nclass MemoryCache<T> {\n  private cache = new Map<string, { value: T; expires: number }>();\n  private defaultTTL: number;\n\n  constructor(defaultTTL = 5 * 60 * 1000) {\n    // 5 minutes default\n    this.defaultTTL = defaultTTL;\n  }\n\n  set(key: string, value: T, ttl?: number): void {\n    const expires = Date.now() + (ttl ?? this.defaultTTL);\n    this.cache.set(key, { value, expires });\n  }\n\n  get(key: string): T | null {\n    const item = this.cache.get(key);\n    if (!item) return null;\n\n    if (Date.now() > item.expires) {\n      this.cache.delete(key);\n      return null;\n    }\n\n    return item.value;\n  }\n\n  has(key: string): boolean {\n    return this.get(key) !== null;\n  }\n\n  delete(key: string): boolean {\n    return this.cache.delete(key);\n  }\n\n  clear(): void {\n    this.cache.clear();\n  }\n\n  size(): number {\n    // Clean expired entries first\n    const now = Date.now();\n    for (const [key, item] of this.cache.entries()) {\n      if (now > item.expires) {\n        this.cache.delete(key);\n      }\n    }\n    return this.cache.size;\n  }\n}\n\n/**\n * Browser storage cache with fallback to memory\n */\nclass BrowserCache<T> {\n  private memoryCache: MemoryCache<T>;\n  private storageKey: string;\n\n  constructor(storageKey: string, defaultTTL = 30 * 60 * 1000) {\n    // 30 minutes default\n    this.storageKey = storageKey;\n    this.memoryCache = new MemoryCache<T>(defaultTTL);\n  }\n\n  private isStorageAvailable(): boolean {\n    try {\n      return typeof window !== 'undefined' && window.localStorage !== undefined;\n    } catch {\n      return false;\n    }\n  }\n\n  private getStorageKey(key: string): string {\n    return `${this.storageKey}:${key}`;\n  }\n\n  set(key: string, value: T, ttl?: number): void {\n    // Always set in memory cache\n    this.memoryCache.set(key, value, ttl);\n\n    // Try to set in localStorage if available\n    if (this.isStorageAvailable()) {\n      try {\n        const expires = Date.now() + (ttl ?? 30 * 60 * 1000);\n        const item = { value, expires };\n        localStorage.setItem(this.getStorageKey(key), JSON.stringify(item));\n      } catch (error) {\n        console.warn('Failed to save to localStorage:', error);\n      }\n    }\n  }\n\n  get(key: string): T | null {\n    // Try memory cache first (fastest)\n    const memoryValue = this.memoryCache.get(key);\n    if (memoryValue !== null) {\n      return memoryValue;\n    }\n\n    // Try localStorage if available\n    if (this.isStorageAvailable()) {\n      try {\n        const stored = localStorage.getItem(this.getStorageKey(key));\n        if (stored) {\n          const item = JSON.parse(stored);\n          if (Date.now() <= item.expires) {\n            // Restore to memory cache for faster access\n            this.memoryCache.set(key, item.value);\n            return item.value;\n          } else {\n            // Clean up expired item\n            localStorage.removeItem(this.getStorageKey(key));\n          }\n        }\n      } catch (error) {\n        console.warn('Failed to read from localStorage:', error);\n      }\n    }\n\n    return null;\n  }\n\n  has(key: string): boolean {\n    return this.get(key) !== null;\n  }\n\n  delete(key: string): void {\n    this.memoryCache.delete(key);\n    if (this.isStorageAvailable()) {\n      try {\n        localStorage.removeItem(this.getStorageKey(key));\n      } catch (error) {\n        console.warn('Failed to delete from localStorage:', error);\n      }\n    }\n  }\n\n  clear(): void {\n    this.memoryCache.clear();\n    if (this.isStorageAvailable()) {\n      try {\n        const keys = Object.keys(localStorage);\n        for (const key of keys) {\n          if (key.startsWith(`${this.storageKey}:`)) {\n            localStorage.removeItem(key);\n          }\n        }\n      } catch (error) {\n        console.warn('Failed to clear localStorage:', error);\n      }\n    }\n  }\n}\n\n/**\n * Debounce function for performance optimization\n */\nexport function debounce<T extends (...args: unknown[]) => unknown>(\n  func: T,\n  wait: number\n): (...args: Parameters<T>) => void {\n  let timeout: NodeJS.Timeout | null = null;\n\n  return (...args: Parameters<T>) => {\n    if (timeout) {\n      clearTimeout(timeout);\n    }\n    timeout = setTimeout(() => func(...args), wait);\n  };\n}\n\n/**\n * Throttle function for performance optimization\n */\nexport function throttle<T extends (...args: unknown[]) => unknown>(\n  func: T,\n  limit: number\n): (...args: Parameters<T>) => void {\n  let inThrottle = false;\n\n  return (...args: Parameters<T>) => {\n    if (!inThrottle) {\n      func(...args);\n      inThrottle = true;\n      setTimeout(() => {\n        inThrottle = false;\n      }, limit);\n    }\n  };\n}\n\n/**\n * Memoization with cache for expensive computations\n */\nexport function memoize<T extends (...args: unknown[]) => unknown>(\n  func: T,\n  keyGenerator?: (...args: Parameters<T>) => string\n): T {\n  const cache = new Map<string, ReturnType<T>>();\n\n  return ((...args: Parameters<T>): ReturnType<T> => {\n    const key = keyGenerator ? keyGenerator(...args) : JSON.stringify(args);\n\n    if (cache.has(key)) {\n      return cache.get(key)!;\n    }\n\n    const result = func(...args) as ReturnType<T>;\n    cache.set(key, result);\n    return result;\n  }) as T;\n}\n\n/**\n * Preload resources for better performance\n */\nexport function preloadResource(href: string, as: string): void {\n  if (typeof window === 'undefined') return;\n\n  const link = document.createElement('link');\n  link.rel = 'preload';\n  link.href = href;\n  link.as = as;\n  document.head.appendChild(link);\n}\n\n/**\n * Lazy load images with intersection observer\n */\nexport function lazyLoadImage(img: HTMLImageElement, src: string): void {\n  if (typeof window === 'undefined' || !('IntersectionObserver' in window)) {\n    img.src = src;\n    return;\n  }\n\n  const observer = new IntersectionObserver(\n    (entries) => {\n      entries.forEach((entry) => {\n        if (entry.isIntersecting) {\n          img.src = src;\n          observer.unobserve(img);\n        }\n      });\n    },\n    { threshold: 0.1 }\n  );\n\n  observer.observe(img);\n}\n\n/**\n * Performance monitoring utilities\n */\nexport namespace PerformanceMonitor {\n  const marks = new Map<string, number>();\n\n  export function mark(name: string): void {\n    if (typeof window !== 'undefined' && window.performance) {\n      window.performance.mark(name);\n      marks.set(name, Date.now());\n    }\n  }\n\n  export function measure(name: string, startMark: string, endMark?: string): number | null {\n    if (typeof window === 'undefined' || !window.performance) {\n      // Fallback measurement\n      const startTime = marks.get(startMark);\n      const endTime = endMark ? marks.get(endMark) : Date.now();\n      return startTime && endTime ? endTime - startTime : null;\n    }\n\n    try {\n      if (endMark) {\n        window.performance.measure(name, startMark, endMark);\n      } else {\n        window.performance.measure(name, startMark);\n      }\n\n      const entries = window.performance.getEntriesByName(name, 'measure');\n      return entries.length > 0 ? entries[entries.length - 1].duration : null;\n    } catch (error) {\n      console.warn('Performance measurement failed:', error);\n      return null;\n    }\n  }\n\n  export function getNavigationTiming(): Record<string, number> | null {\n    if (typeof window === 'undefined' || !window.performance?.timing) {\n      return null;\n    }\n\n    const timing = window.performance.timing;\n    return {\n      domContentLoaded: timing.domContentLoadedEventEnd - timing.navigationStart,\n      loadComplete: timing.loadEventEnd - timing.navigationStart,\n      domInteractive: timing.domInteractive - timing.navigationStart,\n      firstPaint: timing.responseEnd - timing.navigationStart,\n    };\n  }\n}\n\n// Export cache instances for common use cases\nexport const apiCache = new BrowserCache<unknown>('proposal-prepper-api', 10 * 60 * 1000); // 10 minutes\nexport const uiStateCache = new MemoryCache<unknown>(60 * 1000); // 1 minute\nexport const resultsCache = new BrowserCache<unknown>('proposal-prepper-results', 60 * 60 * 1000); // 1 hour\n\n// Export cache classes for custom instances\nexport { MemoryCache, BrowserCache };\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 495, "column": 0}, "map": {"version":3,"sources":["file:///Users/afos/Downloads/CtrlCheck-af-nonopen/proposal-prepper-web/src/config/api-config.ts"],"sourcesContent":["/*\n * SPDX-License-Identifier: AGPL-3.0-or-later\n * SPDX-FileCopyrightText: 2025 Seventeen Sierra LLC\n */\n\n/**\n * Framework-Independent API Configuration\n *\n * Provides flexible configuration for different deployment scenarios\n * and framework integrations. Supports environment-based configuration\n * and runtime switching between real and mock APIs.\n */\n\nexport interface ApiEndpoints {\n  upload: string;\n  uploadStatus: (sessionId: string) => string;\n  analysisStart: string;\n  analysisStatus: (sessionId: string) => string;\n  analysisResults: (sessionId: string) => string;\n  issueDetails: (issueId: string) => string;\n  health: string;\n}\n\nexport interface ApiConfiguration {\n  baseUrl: string;\n  endpoints: ApiEndpoints;\n  useMock: boolean;\n  timeout: number;\n  retries: number;\n  retryDelay: number;\n}\n\n/**\n * Default API endpoints structure\n */\nconst DEFAULT_ENDPOINTS: ApiEndpoints = {\n  upload: '/api/documents/upload',\n  uploadStatus: (sessionId: string) => `/api/documents/upload/${sessionId}`,\n  analysisStart: '/api/analysis/start',\n  analysisStatus: (sessionId: string) => `/api/analysis/${sessionId}`,\n  analysisResults: (sessionId: string) => `/api/analysis/${sessionId}/results`,\n  issueDetails: (issueId: string) => `/api/results/issues/${issueId}`,\n  health: '/api/health',\n};\n\n/**\n * Environment variable names for configuration\n */\nconst ENV_VARS = {\n  STRANDS_API_URL: 'STRANDS_API_URL',\n  MOCK_API_URL: 'MOCK_API_URL',\n  USE_MOCK_API: 'USE_MOCK_API',\n  API_TIMEOUT: 'API_TIMEOUT',\n  API_RETRIES: 'API_RETRIES',\n  API_RETRY_DELAY: 'API_RETRY_DELAY',\n} as const;\n\n/**\n * Get environment variable with fallback\n */\nfunction getEnvVar(name: string, fallback: string = ''): string {\n  if (typeof process !== 'undefined' && process.env) {\n    return process.env[name] || fallback;\n  }\n  return fallback;\n}\n\n/**\n * Get boolean environment variable\n */\nfunction getBooleanEnvVar(name: string, fallback: boolean = false): boolean {\n  const value = getEnvVar(name);\n  if (!value) return fallback;\n  return value.toLowerCase() === 'true' || value === '1';\n}\n\n/**\n * Get number environment variable\n */\nfunction getNumberEnvVar(name: string, fallback: number): number {\n  const value = getEnvVar(name);\n  if (!value) return fallback;\n  const parsed = parseInt(value, 10);\n  return Number.isNaN(parsed) ? fallback : parsed;\n}\n\n/**\n * Determine if we should use mock APIs\n */\nfunction shouldUseMockApi(): boolean {\n  // Explicit environment variable override\n  if (getEnvVar(ENV_VARS.USE_MOCK_API)) {\n    return getBooleanEnvVar(ENV_VARS.USE_MOCK_API);\n  }\n\n  // Development mode defaults to mock\n  if (getEnvVar('NODE_ENV') === 'development') {\n    return true;\n  }\n\n  // Browser-based detection for client-side\n  if (typeof window !== 'undefined') {\n    // Check URL path for mock indicator\n    if (window.location.pathname.includes('/mock')) {\n      return true;\n    }\n\n    // Check localStorage override\n    const mockOverride = localStorage.getItem('use-mock-api');\n    if (mockOverride !== null) {\n      return mockOverride === 'true';\n    }\n  }\n\n  return false;\n}\n\n/**\n * Get the appropriate API base URL\n */\nfunction getApiBaseUrl(): string {\n  const useMock = shouldUseMockApi();\n\n  if (useMock) {\n    // Mock API URL (could be Next.js routes, Express server, etc.)\n    const mockUrl = getEnvVar(ENV_VARS.MOCK_API_URL);\n    if (mockUrl) return mockUrl;\n\n    // Default mock URLs for different environments\n    if (typeof window !== 'undefined') {\n      // Browser environment - use current origin for Next.js routes\n      return window.location.origin;\n    } else {\n      // Server environment - default to localhost\n      return 'http://localhost:3000';\n    }\n  }\n\n  // Real Strands API URL - prioritize Docker container networking\n  const realUrl = getEnvVar(ENV_VARS.STRANDS_API_URL) || getEnvVar('STRANDS_SERVICE_URL');\n  if (realUrl) return realUrl;\n\n  // Default real API URL - use Docker service name for server-side, localhost for client-side\n  if (typeof window !== 'undefined') {\n    // Browser environment - use localhost\n    return 'http://localhost:8080';\n  } else {\n    // Server environment - use Docker service name\n    return 'http://strands:8080';\n  }\n}\n\n/**\n * Create API configuration based on environment\n */\nexport function createApiConfiguration(overrides?: Partial<ApiConfiguration>): ApiConfiguration {\n  const baseConfig: ApiConfiguration = {\n    baseUrl: getApiBaseUrl(),\n    endpoints: DEFAULT_ENDPOINTS,\n    useMock: shouldUseMockApi(),\n    timeout: getNumberEnvVar(ENV_VARS.API_TIMEOUT, 30000), // 30 seconds\n    retries: getNumberEnvVar(ENV_VARS.API_RETRIES, 3),\n    retryDelay: getNumberEnvVar(ENV_VARS.API_RETRY_DELAY, 1000), // 1 second\n  };\n\n  return { ...baseConfig, ...overrides };\n}\n\n/**\n * Default API configuration instance\n */\nexport const apiConfiguration = createApiConfiguration();\n\n/**\n * Runtime API configuration switching\n */\nexport class ApiConfigurationManager {\n  private static instance: ApiConfigurationManager;\n  private config: ApiConfiguration;\n  private listeners: Set<(config: ApiConfiguration) => void> = new Set();\n\n  private constructor() {\n    this.config = createApiConfiguration();\n  }\n\n  static getInstance(): ApiConfigurationManager {\n    if (!ApiConfigurationManager.instance) {\n      ApiConfigurationManager.instance = new ApiConfigurationManager();\n    }\n    return ApiConfigurationManager.instance;\n  }\n\n  /**\n   * Get current configuration\n   */\n  getConfiguration(): ApiConfiguration {\n    return { ...this.config };\n  }\n\n  /**\n   * Update configuration\n   */\n  updateConfiguration(updates: Partial<ApiConfiguration>): void {\n    this.config = { ...this.config, ...updates };\n    this.notifyListeners();\n  }\n\n  /**\n   * Switch to mock API\n   */\n  useMockApi(mockBaseUrl?: string): void {\n    this.updateConfiguration({\n      useMock: true,\n      baseUrl: mockBaseUrl || this.config.baseUrl,\n    });\n  }\n\n  /**\n   * Switch to real API\n   */\n  useRealApi(realBaseUrl?: string): void {\n    this.updateConfiguration({\n      useMock: false,\n      baseUrl: realBaseUrl || getEnvVar(ENV_VARS.STRANDS_API_URL, 'http://localhost:8080'),\n    });\n  }\n\n  /**\n   * Subscribe to configuration changes\n   */\n  subscribe(listener: (config: ApiConfiguration) => void): () => void {\n    this.listeners.add(listener);\n    return () => this.listeners.delete(listener);\n  }\n\n  /**\n   * Notify all listeners of configuration changes\n   */\n  private notifyListeners(): void {\n    this.listeners.forEach((listener) => {\n      listener(this.config);\n    });\n  }\n\n  /**\n   * Reset to default configuration\n   */\n  reset(): void {\n    this.config = createApiConfiguration();\n    this.notifyListeners();\n  }\n}\n\n/**\n * Global configuration manager instance\n */\nexport const apiConfigManager = ApiConfigurationManager.getInstance();\n\n/**\n * Utility functions for common configuration scenarios\n */\nexport const ApiConfigUtils = {\n  /**\n   * Configure for Next.js development\n   */\n  configureForNextJs(port = 3000): void {\n    apiConfigManager.updateConfiguration({\n      baseUrl: `http://localhost:${port}`,\n      useMock: true,\n    });\n  },\n\n  /**\n   * Configure for Express server\n   */\n  configureForExpress(port = 8080): void {\n    apiConfigManager.updateConfiguration({\n      baseUrl: `http://localhost:${port}`,\n      useMock: false,\n    });\n  },\n\n  /**\n   * Configure for standalone mock server\n   */\n  configureForStandaloneMock(port = 8081): void {\n    apiConfigManager.updateConfiguration({\n      baseUrl: `http://localhost:${port}`,\n      useMock: true,\n    });\n  },\n\n  /**\n   * Configure for production\n   */\n  configureForProduction(apiUrl: string): void {\n    apiConfigManager.updateConfiguration({\n      baseUrl: apiUrl,\n      useMock: false,\n      timeout: 60000, // Longer timeout for production\n      retries: 5, // More retries for production\n    });\n  },\n\n  /**\n   * Get configuration for current environment\n   */\n  getEnvironmentConfig(): ApiConfiguration {\n    return apiConfigManager.getConfiguration();\n  },\n};\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 729, "column": 0}, "map": {"version":3,"sources":["file:///Users/afos/Downloads/CtrlCheck-af-nonopen/proposal-prepper-services/src/ai-router-client.ts"],"sourcesContent":["// SPDX-License-Identifier: AGPL-3.0-or-later\n// SPDX-FileCopyrightText: 2025 Seventeen Sierra LLC\n\n/**\n * Strands API Client\n *\n * HTTP/REST and WebSocket client for communicating with the Strands service.\n * Provides document upload, analysis orchestration, and results retrieval.\n * Implements requirements 1.1, 2.1, and 3.1 for API integration.\n *\n * Performance optimizations for Requirement 5.1: Load time performance\n */\n\nimport { apiConfig, errorConfig } from '@/config/app';\nimport { apiCache, PerformanceMonitor } from '@/utils/performance';\n\n/**\n * API Response wrapper for consistent error handling\n */\nexport interface ApiResponse<T> {\n  success: boolean;\n  data?: T;\n  error?: string;\n  code?: string;\n}\n\n/**\n * Upload session data from Strands API\n */\nexport interface UploadSessionResponse {\n  id: string;\n  filename: string;\n  fileSize: number;\n  mimeType: string;\n  status: 'pending' | 'uploading' | 'processing' | 'completed' | 'failed';\n  progress: number;\n  startedAt: string;\n  completedAt?: string;\n  errorMessage?: string;\n  s3Key?: string;\n}\n\n/**\n * Analysis session data from Strands API\n */\nexport interface AnalysisSessionResponse {\n  id: string;\n  proposalId: string;\n  status: 'queued' | 'extracting' | 'analyzing' | 'validating' | 'completed' | 'failed';\n  progress: number;\n  startedAt: string;\n  completedAt?: string;\n  estimatedCompletion?: string;\n  currentStep: string;\n}\n\n/**\n * Compliance results from Strands API\n */\nexport interface ComplianceResultsResponse {\n  id: string;\n  proposalId: string;\n  status: 'pass' | 'fail' | 'warning';\n  issues: ComplianceIssue[];\n  summary: {\n    totalIssues: number;\n    criticalIssues: number;\n    warningIssues: number;\n  };\n  generatedAt: string;\n}\n\n/**\n * Individual compliance issue\n */\nexport interface ComplianceIssue {\n  id: string;\n  severity: 'critical' | 'warning' | 'info';\n  title: string;\n  description: string;\n  regulation: {\n    framework: 'FAR' | 'DFARS';\n    section: string;\n    reference: string;\n  };\n  location?: {\n    page: number;\n    section: string;\n    text: string;\n  };\n  remediation?: string;\n}\n\n/**\n * WebSocket message types for real-time updates\n */\nexport interface WebSocketMessage {\n  type: 'upload_progress' | 'analysis_progress' | 'analysis_complete' | 'error';\n  sessionId: string;\n  data: unknown;\n}\n\n/**\n * HTTP client with retry logic and error handling\n */\nclass HttpClient {\n  private baseUrl: string;\n  private timeout: number;\n  private maxRetries: number;\n  private retryDelay: number;\n\n  constructor(baseUrl: string) {\n    this.baseUrl = baseUrl;\n    this.timeout = apiConfig.requestTimeout;\n    this.maxRetries = apiConfig.maxRetries;\n    this.retryDelay = apiConfig.retryDelay;\n  }\n\n  /**\n   * Make HTTP request with retry logic and caching\n   * Performance optimization for Requirement 5.1\n   */\n  private async makeRequest<T>(\n    endpoint: string,\n    options: RequestInit = {},\n    cacheKey?: string,\n    cacheTTL?: number\n  ): Promise<ApiResponse<T>> {\n    // Check cache for GET requests\n    if (options.method === 'GET' && cacheKey) {\n      const cached = apiCache.get(cacheKey);\n      if (cached) {\n        return { success: true, data: cached as T };\n      }\n    }\n\n    const url = `${this.baseUrl}${endpoint}`;\n    let lastError: Error | null = null;\n\n    // Performance monitoring\n    const requestId = `api-request-${Date.now()}`;\n    PerformanceMonitor.mark(`${requestId}-start`);\n\n    for (let attempt = 0; attempt <= this.maxRetries; attempt++) {\n      try {\n        const controller = new AbortController();\n        const timeoutId = setTimeout(() => controller.abort(), this.timeout);\n\n        const response = await fetch(url, {\n          ...options,\n          signal: controller.signal,\n          headers: {\n            'Content-Type': 'application/json',\n            ...options.headers,\n          },\n        });\n\n        clearTimeout(timeoutId);\n\n        if (!response.ok) {\n          throw new Error(`HTTP ${response.status}: ${response.statusText}`);\n        }\n\n        const data = await response.json();\n\n        // Cache successful GET responses\n        if (options.method === 'GET' && cacheKey && data) {\n          apiCache.set(cacheKey, data, cacheTTL);\n        }\n\n        // Performance monitoring\n        PerformanceMonitor.mark(`${requestId}-end`);\n        const duration = PerformanceMonitor.measure(\n          requestId,\n          `${requestId}-start`,\n          `${requestId}-end`\n        );\n        if (duration && duration > 1000) {\n          console.warn(`Slow API request: ${endpoint} took ${duration}ms`);\n        }\n\n        return { success: true, data };\n      } catch (error) {\n        lastError = error as Error;\n\n        // Don't retry on client errors (4xx)\n        if (error instanceof Error && error.message.includes('HTTP 4')) {\n          break;\n        }\n\n        // Wait before retry (except on last attempt)\n        if (attempt < this.maxRetries) {\n          await new Promise((resolve) => setTimeout(resolve, this.retryDelay * (attempt + 1)));\n        }\n      }\n    }\n\n    return {\n      success: false,\n      error: lastError?.message || errorConfig.defaultErrorMessage,\n      code: this.getErrorCode(lastError),\n    };\n  }\n\n  /**\n   * Get appropriate error code based on error type\n   */\n  private getErrorCode(error: Error | null): string {\n    if (!error) return errorConfig.codes.NETWORK_ERROR;\n\n    if (error.name === 'AbortError') {\n      return errorConfig.codes.TIMEOUT_ERROR;\n    }\n\n    if (error.message.includes('HTTP 4')) {\n      return errorConfig.codes.VALIDATION_FAILED;\n    }\n\n    // Check for specific connection errors\n    if (\n      error.message.includes('ECONNREFUSED') ||\n      error.message.includes('ENOTFOUND') ||\n      error.message.includes('ECONNRESET')\n    ) {\n      return 'SERVICE_UNAVAILABLE';\n    }\n\n    if (error.message.includes('HTTP 5')) {\n      return 'SERVICE_ERROR';\n    }\n\n    return errorConfig.codes.NETWORK_ERROR;\n  }\n\n  /**\n   * GET request with caching\n   */\n  async get<T>(endpoint: string, cacheTTL?: number): Promise<ApiResponse<T>> {\n    const cacheKey = `GET:${endpoint}`;\n    return this.makeRequest<T>(endpoint, { method: 'GET' }, cacheKey, cacheTTL);\n  }\n\n  /**\n   * POST request\n   */\n  async post<T>(endpoint: string, data?: unknown): Promise<ApiResponse<T>> {\n    return this.makeRequest<T>(endpoint, {\n      method: 'POST',\n      body: data ? JSON.stringify(data) : undefined,\n    });\n  }\n\n  /**\n   * PUT request\n   */\n  async put<T>(endpoint: string, data?: unknown): Promise<ApiResponse<T>> {\n    return this.makeRequest<T>(endpoint, {\n      method: 'PUT',\n      body: data ? JSON.stringify(data) : undefined,\n    });\n  }\n\n  /**\n   * DELETE request\n   */\n  async delete<T>(endpoint: string): Promise<ApiResponse<T>> {\n    return this.makeRequest<T>(endpoint, { method: 'DELETE' });\n  }\n\n  /**\n   * Upload file with progress tracking\n   */\n  async uploadFile(\n    endpoint: string,\n    file: File,\n    onProgress?: (progress: number) => void\n  ): Promise<ApiResponse<UploadSessionResponse>> {\n    return new Promise((resolve) => {\n      const xhr = new XMLHttpRequest();\n      const formData = new FormData();\n      formData.append('file', file);\n\n      xhr.upload.addEventListener('progress', (event) => {\n        if (event.lengthComputable && onProgress) {\n          const progress = (event.loaded / event.total) * 100;\n          onProgress(progress);\n        }\n      });\n\n      xhr.addEventListener('load', () => {\n        try {\n          if (xhr.status >= 200 && xhr.status < 300) {\n            const data = JSON.parse(xhr.responseText);\n            resolve({ success: true, data });\n          } else {\n            resolve({\n              success: false,\n              error: `Upload failed: ${xhr.statusText}`,\n              code: errorConfig.codes.UPLOAD_FAILED,\n            });\n          }\n        } catch (_error) {\n          resolve({\n            success: false,\n            error: 'Failed to parse upload response',\n            code: errorConfig.codes.UPLOAD_FAILED,\n          });\n        }\n      });\n\n      xhr.addEventListener('error', () => {\n        resolve({\n          success: false,\n          error: 'Upload network error',\n          code: errorConfig.codes.NETWORK_ERROR,\n        });\n      });\n\n      xhr.addEventListener('timeout', () => {\n        resolve({\n          success: false,\n          error: 'Upload timeout',\n          code: errorConfig.codes.TIMEOUT_ERROR,\n        });\n      });\n\n      xhr.timeout = this.timeout;\n      xhr.open('POST', `${this.baseUrl}${endpoint}`);\n      xhr.send(formData);\n    });\n  }\n}\n\n/**\n * WebSocket client for real-time updates\n */\nclass WebSocketClient {\n  private ws: WebSocket | null = null;\n  private url: string;\n  private reconnectAttempts = 0;\n  private maxReconnectAttempts: number;\n  private reconnectInterval: number;\n  private listeners: Map<string, Set<(message: WebSocketMessage) => void>> = new Map();\n\n  constructor(baseUrl: string) {\n    this.url = `${baseUrl.replace('http', 'ws')}/ws`;\n    this.maxReconnectAttempts = apiConfig.websocket.maxReconnectAttempts;\n    this.reconnectInterval = apiConfig.websocket.reconnectInterval;\n  }\n\n  /**\n   * Connect to WebSocket\n   */\n  connect(): Promise<void> {\n    return new Promise((resolve, reject) => {\n      try {\n        this.ws = new WebSocket(this.url);\n\n        this.ws.onopen = () => {\n          this.reconnectAttempts = 0;\n          resolve();\n        };\n\n        this.ws.onmessage = (event) => {\n          try {\n            const message: WebSocketMessage = JSON.parse(event.data);\n            this.notifyListeners(message.type, message);\n          } catch (error) {\n            console.error('Failed to parse WebSocket message:', error);\n          }\n        };\n\n        this.ws.onclose = () => {\n          this.handleDisconnection();\n        };\n\n        this.ws.onerror = (error) => {\n          console.error('WebSocket error:', error);\n          reject(error);\n        };\n      } catch (error) {\n        reject(error);\n      }\n    });\n  }\n\n  /**\n   * Handle WebSocket disconnection with reconnection logic\n   */\n  private handleDisconnection() {\n    if (this.reconnectAttempts < this.maxReconnectAttempts) {\n      this.reconnectAttempts++;\n      setTimeout(() => {\n        this.connect().catch(console.error);\n      }, this.reconnectInterval * this.reconnectAttempts);\n    }\n  }\n\n  /**\n   * Subscribe to WebSocket messages of a specific type\n   */\n  subscribe(type: string, callback: (message: WebSocketMessage) => void) {\n    if (!this.listeners.has(type)) {\n      this.listeners.set(type, new Set());\n    }\n    this.listeners.get(type)!.add(callback);\n  }\n\n  /**\n   * Unsubscribe from WebSocket messages\n   */\n  unsubscribe(type: string, callback: (message: WebSocketMessage) => void) {\n    const typeListeners = this.listeners.get(type);\n    if (typeListeners) {\n      typeListeners.delete(callback);\n    }\n  }\n\n  /**\n   * Notify all listeners of a message type\n   */\n  private notifyListeners(type: string, message: WebSocketMessage) {\n    const typeListeners = this.listeners.get(type);\n    if (typeListeners) {\n      typeListeners.forEach((callback) => {\n        callback(message);\n      });\n    }\n  }\n\n  /**\n   * Send message through WebSocket\n   */\n  send(message: unknown) {\n    if (this.ws && this.ws.readyState === WebSocket.OPEN) {\n      this.ws.send(JSON.stringify(message));\n    }\n  }\n\n  /**\n   * Close WebSocket connection\n   */\n  disconnect() {\n    if (this.ws) {\n      this.ws.close();\n      this.ws = null;\n    }\n  }\n\n  /**\n   * Check if WebSocket is connected\n   */\n  isConnected(): boolean {\n    return this.ws?.readyState === WebSocket.OPEN;\n  }\n}\n\n/**\n * Main Strands API Client\n *\n * Provides HTTP/REST * AI Router Client\n * \n * Handles communication with the external AI service (formerly Strands).\n * Renamed from StrandsApiClient to AIRouterClient to be more generic.lements error handling, retry logic, and real-time updates.\n */\nexport class AIRouterClient {\n  private httpClient: HttpClient;\n  private wsClient: WebSocketClient;\n  private baseUrl: string;\n  private lastHealthCheck: { timestamp: number; healthy: boolean } | null = null;\n  private healthCheckCacheMs = 30000; // Cache health check for 30 seconds\n\n  constructor(baseUrl: string = apiConfig.strandsBaseUrl) {\n    this.baseUrl = baseUrl;\n    this.httpClient = new HttpClient(baseUrl);\n    this.wsClient = new WebSocketClient(baseUrl);\n  }\n\n  /**\n   * Get the base URL being used by this client\n   */\n  getBaseUrl(): string {\n    return this.baseUrl;\n  }\n\n  // Document Upload Methods\n\n  /**\n   * Upload a document file\n   * Requirement 1.1: Accept PDF format files\n   */\n  async uploadDocument(\n    file: File,\n    onProgress?: (progress: number) => void\n  ): Promise<ApiResponse<UploadSessionResponse>> {\n    return this.httpClient.uploadFile('/api/documents/upload', file, onProgress);\n  }\n\n  /**\n   * Get upload session status with short-term caching\n   */\n  async getUploadStatus(sessionId: string): Promise<ApiResponse<UploadSessionResponse>> {\n    return this.httpClient.get<UploadSessionResponse>(`/api/documents/upload/${sessionId}`, 30000); // 30 seconds cache\n  }\n\n  // Analysis Methods\n\n  /**\n   * Start compliance analysis\n   * Requirement 2.1: Validate against core FAR/DFARS requirements\n   */\n  async startAnalysis(\n    proposalId: string,\n    documentId?: string,\n    filename?: string,\n    s3Key?: string\n  ): Promise<ApiResponse<AnalysisSessionResponse>> {\n    // Check service health before attempting analysis\n    if (!(await this.isServiceHealthy())) {\n      return {\n        success: false,\n        error: 'Strands service is not available. Please try again later.',\n        code: 'SERVICE_UNAVAILABLE',\n      };\n    }\n\n    return this.httpClient.post<AnalysisSessionResponse>('/api/analysis/start', {\n      proposal_id: proposalId,\n      document_id: documentId || proposalId,\n      filename: filename || 'document.pdf',\n      s3_key: s3Key || `uploads/${proposalId}/${filename || 'document.pdf'}`,\n      frameworks: ['FAR', 'DFARS'],\n    });\n  }\n\n  /**\n   * Get analysis session status with short-term caching\n   */\n  async getAnalysisStatus(sessionId: string): Promise<ApiResponse<AnalysisSessionResponse>> {\n    return this.httpClient.get<AnalysisSessionResponse>(`/api/analysis/${sessionId}`, 15000); // 15 seconds cache\n  }\n\n  /**\n   * Cancel analysis session\n   */\n  async cancelAnalysis(sessionId: string): Promise<ApiResponse<void>> {\n    return this.httpClient.delete<void>(`/api/analysis/${sessionId}`);\n  }\n\n  // Results Methods\n\n  /**\n   * Get compliance analysis results with longer caching\n   * Requirement 3.1: Show compliance status and findings\n   */\n  async getResults(sessionId: string): Promise<ApiResponse<ComplianceResultsResponse>> {\n    return this.httpClient.get<ComplianceResultsResponse>(\n      `/api/analysis/${sessionId}/results`,\n      300000\n    ); // 5 minutes cache\n  }\n\n  /**\n   * Get specific compliance issue details with caching\n   */\n  async getIssueDetails(issueId: string): Promise<ApiResponse<ComplianceIssue>> {\n    return this.httpClient.get<ComplianceIssue>(`/api/results/issues/${issueId}`, 600000); // 10 minutes cache\n  }\n\n  // WebSocket Methods\n\n  /**\n   * Connect to real-time updates\n   */\n  async connectWebSocket(): Promise<void> {\n    return this.wsClient.connect();\n  }\n\n  /**\n   * Subscribe to upload progress updates\n   */\n  subscribeToUploadProgress(callback: (progress: WebSocketMessage) => void) {\n    this.wsClient.subscribe('upload_progress', callback);\n  }\n\n  /**\n   * Subscribe to analysis progress updates\n   */\n  subscribeToAnalysisProgress(callback: (progress: WebSocketMessage) => void) {\n    this.wsClient.subscribe('analysis_progress', callback);\n  }\n\n  /**\n   * Subscribe to analysis completion\n   */\n  subscribeToAnalysisComplete(callback: (result: WebSocketMessage) => void) {\n    this.wsClient.subscribe('analysis_complete', callback);\n  }\n\n  /**\n   * Subscribe to error notifications\n   */\n  subscribeToErrors(callback: (error: WebSocketMessage) => void) {\n    this.wsClient.subscribe('error', callback);\n  }\n\n  /**\n   * Unsubscribe from WebSocket updates\n   */\n  unsubscribe(type: string, callback: (message: WebSocketMessage) => void) {\n    this.wsClient.unsubscribe(type, callback);\n  }\n\n  /**\n   * Disconnect from WebSocket\n   */\n  disconnectWebSocket() {\n    this.wsClient.disconnect();\n  }\n\n  /**\n   * Simulate document upload using seeded data\n   */\n  async simulateUpload(filename: string): Promise<ApiResponse<UploadSessionResponse>> {\n    // Check service health\n    if (!(await this.isServiceHealthy())) {\n      return {\n        success: false,\n        error: 'Strands service is not available',\n        code: 'SERVICE_UNAVAILABLE',\n      };\n    }\n\n    return this.httpClient.post<UploadSessionResponse>('/api/documents/simulate-upload', {\n      filename,\n    });\n  }\n\n  /**\n   * Check WebSocket connection status\n   */\n  isWebSocketConnected(): boolean {\n    return this.wsClient.isConnected();\n  }\n\n  // Health Check\n\n  /**\n   * Check if Strands service is available\n   */\n  async healthCheck(): Promise<\n    ApiResponse<{ status: string; version: string; checks?: Record<string, string> }>\n  > {\n    const result = await this.httpClient.get<{\n      status: string;\n      version: string;\n      checks?: Record<string, string>;\n    }>('/api/health');\n\n    // Update health check cache\n    this.lastHealthCheck = {\n      timestamp: Date.now(),\n      healthy:\n        result.success && (result.data?.status === 'healthy' || result.data?.status === 'degraded'),\n    };\n\n    return result;\n  }\n\n  /**\n   * Check if Strands service is healthy and ready for requests\n   * Uses cached result if available and recent\n   */\n  async isServiceHealthy(): Promise<boolean> {\n    // Use cached result if available and recent\n    if (\n      this.lastHealthCheck &&\n      Date.now() - this.lastHealthCheck.timestamp < this.healthCheckCacheMs\n    ) {\n      return this.lastHealthCheck.healthy;\n    }\n\n    try {\n      const result = await this.healthCheck();\n      return (\n        result.success && (result.data?.status === 'healthy' || result.data?.status === 'degraded')\n      );\n    } catch (_error) {\n      // Update cache with failure\n      this.lastHealthCheck = {\n        timestamp: Date.now(),\n        healthy: false,\n      };\n      return false;\n    }\n  }\n\n  /**\n   * Wait for service to become healthy with timeout\n   */\n  async waitForService(timeoutMs: number = 30000): Promise<boolean> {\n    const startTime = Date.now();\n    const checkInterval = 2000; // Check every 2 seconds\n\n    while (Date.now() - startTime < timeoutMs) {\n      if (await this.isServiceHealthy()) {\n        return true;\n      }\n      await new Promise((resolve) => setTimeout(resolve, checkInterval));\n    }\n    return false;\n  }\n\n  /**\n   * Get detailed service status including all health checks\n   */\n  async getServiceStatus(): Promise<{\n    healthy: boolean;\n    baseUrl: string;\n    status?: string;\n    version?: string;\n    checks?: Record<string, string>;\n    lastChecked?: number;\n    error?: string;\n  }> {\n    try {\n      const result = await this.healthCheck();\n\n      return {\n        healthy:\n          result.success &&\n          (result.data?.status === 'healthy' || result.data?.status === 'degraded'),\n        baseUrl: this.baseUrl,\n        status: result.data?.status,\n        version: result.data?.version,\n        checks: result.data?.checks,\n        lastChecked: Date.now(),\n        error: result.success ? undefined : result.error,\n      };\n    } catch (error) {\n      return {\n        healthy: false,\n        baseUrl: this.baseUrl,\n        lastChecked: Date.now(),\n        error: error instanceof Error ? error.message : 'Unknown error',\n      };\n    }\n  }\n}\n\n/**\n * Smart API client factory that routes requests appropriately\n * \n * SECURITY: In browser context, always use same-origin (window.location.origin)\n * to route requests through Next.js API routes. This avoids CORS issues and\n * keeps the backend URL private. The Next.js server-side routes will proxy\n * to the real backend.\n */\nfunction createAIRouterClient() {\n  // In browser context, always use same-origin to avoid CORS\n  // Requests go through Next.js API routes which proxy to backend\n  if (typeof window !== 'undefined') {\n    return new AIRouterClient(window.location.origin);\n  }\n\n  // Server-side: use the configured backend URL\n  // Import configuration dynamically to avoid circular dependencies\n  let config;\n  try {\n    const configModule = require('@/config/api-config');\n    config = configModule.apiConfiguration;\n  } catch (_error) {\n    // Fallback configuration if api-config is not available\n    const baseUrl = apiConfig.useMockApis ? 'http://localhost:3000' : apiConfig.strandsBaseUrl;\n\n    config = {\n      baseUrl,\n      useMock: apiConfig.useMockApis,\n    };\n  }\n\n  return new AIRouterClient(config.baseUrl);\n}\n\n/**\n * Create a Strands API client with explicit configuration\n * Useful for testing or specific deployment scenarios\n */\nexport function createAIRouterClientWithConfig(baseUrl: string, _useMock: boolean = false) {\n  return new AIRouterClient(baseUrl);\n}\n\n/**\n * Default Strands API client instance\n * Automatically switches between real and mock APIs based on environment\n */\nexport const aiRouterClient = createAIRouterClient();\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1274, "column": 0}, "map": {"version":3,"sources":["file:///Users/afos/Downloads/CtrlCheck-af-nonopen/proposal-prepper-services/src/upload-service.ts"],"sourcesContent":["// SPDX-License-Identifier: AGPL-3.0-or-later\n// SPDX-FileCopyrightText: 2025 Seventeen Sierra LLC\n\n/**\n * Upload Service\n *\n * Service layer for managing document uploads and integrating with the Strands API.\n * Provides upload session management, progress tracking, and error handling.\n * Implements requirements 1.1, 1.2, 1.3, 1.4, and 1.5 for upload functionality.\n */\n\nimport { errorConfig, uploadConfig } from '@/config/app';\nimport { type UploadSession, UploadStatus } from '@/types/app';\nimport { aiRouterClient, type UploadSessionResponse } from './ai-router-client';\n\n/**\n * Upload service events\n */\nexport interface UploadServiceEvents {\n  onProgress: (sessionId: string, progress: number) => void;\n  onComplete: (sessionId: string, session: UploadSession) => void;\n  onError: (sessionId: string, error: string) => void;\n}\n\n/**\n * Upload Service Class\n *\n * Manages document uploads with the Strands API, providing session tracking,\n * progress monitoring, and error handling capabilities.\n */\nexport class UploadService {\n  private activeSessions = new Map<string, UploadSession>();\n  private eventHandlers: Partial<UploadServiceEvents> = {};\n\n  /**\n   * Set event handlers for upload events\n   */\n  setEventHandlers(handlers: Partial<UploadServiceEvents>) {\n    this.eventHandlers = { ...this.eventHandlers, ...handlers };\n  }\n\n  /**\n   * Upload a document file\n   * Requirement 1.1: Accept PDF format files\n   * Requirement 1.5: Show upload progress and status\n   */\n  async uploadDocument(\n    file: File,\n    sessionId?: string\n  ): Promise<{ success: boolean; sessionId: string; error?: string }> {\n    // Create or update session\n    const session: UploadSession =\n      sessionId && this.activeSessions.has(sessionId)\n        ? { ...this.activeSessions.get(sessionId)!, status: UploadStatus.UPLOADING }\n        : {\n          id: sessionId || `upload_${Date.now()}_${Math.random().toString(36).substring(2, 11)}`,\n          filename: file.name,\n          fileSize: file.size,\n          mimeType: file.type,\n          status: UploadStatus.UPLOADING,\n          progress: 0,\n          startedAt: new Date(),\n        };\n\n    this.activeSessions.set(session.id, session);\n\n    try {\n      // Upload file with progress tracking\n      const response = await aiRouterClient.uploadDocument(file, (progress) => {\n        const updatedSession = { ...session, progress };\n        this.activeSessions.set(session.id, updatedSession);\n        this.eventHandlers.onProgress?.(session.id, progress);\n      });\n\n      if (response.success && response.data) {\n        // Update session with server response\n        const completedSession: UploadSession = {\n          ...session,\n          id: response.data.id, // Use server-generated ID\n          status: UploadStatus.COMPLETED,\n          progress: 100,\n          completedAt: new Date(),\n        };\n\n        // Remove the original session if the ID changed\n        if (session.id !== completedSession.id) {\n          this.activeSessions.delete(session.id);\n        }\n\n        this.activeSessions.set(completedSession.id, completedSession);\n        this.eventHandlers.onComplete?.(completedSession.id, completedSession);\n\n        return { success: true, sessionId: completedSession.id };\n      } else {\n        const error = response.error || 'Upload failed';\n        const failedSession = {\n          ...session,\n          status: UploadStatus.FAILED,\n          errorMessage: error,\n        };\n        this.activeSessions.set(session.id, failedSession);\n        this.eventHandlers.onError?.(session.id, error);\n\n        return { success: false, sessionId: session.id, error };\n      }\n    } catch (error) {\n      const errorMessage = error instanceof Error ? error.message : 'Upload failed';\n      const failedSession = {\n        ...session,\n        status: UploadStatus.FAILED,\n        errorMessage,\n      };\n      this.activeSessions.set(session.id, failedSession);\n      this.eventHandlers.onError?.(session.id, errorMessage);\n\n      return { success: false, sessionId: session.id, error: errorMessage };\n    }\n  }\n\n  /**\n   * Get upload session status\n   * Requirement 1.5: Show upload progress and status\n   */\n  async getUploadStatus(sessionId: string): Promise<UploadSession | null> {\n    // Check local session first\n    const localSession = this.activeSessions.get(sessionId);\n    if (localSession && localSession.status !== UploadStatus.COMPLETED) {\n      return localSession;\n    }\n\n    // Query server for completed sessions\n    try {\n      const response = await aiRouterClient.getUploadStatus(sessionId);\n      if (response.success && response.data) {\n        const session = this.mapApiResponseToSession(response.data);\n        this.activeSessions.set(sessionId, session);\n        return session;\n      }\n    } catch (error) {\n      console.error('Failed to get upload status:', error);\n    }\n\n    return localSession || null;\n  }\n\n  /**\n   * Get all active upload sessions\n   */\n  getActiveSessions(): UploadSession[] {\n    return Array.from(this.activeSessions.values());\n  }\n\n  /**\n   * Cancel an upload session\n   */\n  cancelUpload(sessionId: string): boolean {\n    const session = this.activeSessions.get(sessionId);\n    if (session && session.status === UploadStatus.UPLOADING) {\n      const cancelledSession = {\n        ...session,\n        status: UploadStatus.FAILED,\n        errorMessage: 'Upload cancelled by user',\n      };\n      this.activeSessions.set(sessionId, cancelledSession);\n      return true;\n    }\n    return false;\n  }\n\n  /**\n   * Clear completed or failed sessions\n   */\n  clearSession(sessionId: string): boolean {\n    const session = this.activeSessions.get(sessionId);\n    if (\n      session &&\n      (session.status === UploadStatus.COMPLETED || session.status === UploadStatus.FAILED)\n    ) {\n      this.activeSessions.delete(sessionId);\n      return true;\n    }\n    return false;\n  }\n\n  /**\n   * Clear all sessions\n   */\n  clearAllSessions(): void {\n    this.activeSessions.clear();\n  }\n\n  /**\n   * Validate file before upload\n   * Requirement 1.1: PDF format validation\n   * Requirement 1.2: File size validation\n   */\n  validateFile(file: File): { isValid: boolean; error?: string; errorCode?: string } {\n    // Check file type (requirement 1.1: PDF format only)\n    if (\n      !uploadConfig.acceptedTypes.includes(file.type as (typeof uploadConfig.acceptedTypes)[number])\n    ) {\n      return {\n        isValid: false,\n        error: 'Only PDF files are accepted for upload.',\n        errorCode: errorConfig.codes.VALIDATION_FAILED,\n      };\n    }\n\n    // Check file size limits (requirement 1.2)\n    if (file.size > uploadConfig.maxFileSize) {\n      const maxSizeMB = Math.round(uploadConfig.maxFileSize / (1024 * 1024));\n      return {\n        isValid: false,\n        error: `File size exceeds the maximum limit of ${maxSizeMB}MB.`,\n        errorCode: errorConfig.codes.VALIDATION_FAILED,\n      };\n    }\n\n    if (file.size < uploadConfig.minFileSize) {\n      return {\n        isValid: false,\n        error: 'File is too small. Please select a valid PDF document.',\n        errorCode: errorConfig.codes.VALIDATION_FAILED,\n      };\n    }\n\n    // Check filename validity\n    if (file.name.length > 255) {\n      return {\n        isValid: false,\n        error: 'Filename is too long. Maximum 255 characters allowed.',\n        errorCode: errorConfig.codes.VALIDATION_FAILED,\n      };\n    }\n\n    return { isValid: true };\n  }\n\n  /**\n   * Map API response to internal session format\n   */\n  private mapApiResponseToSession(apiResponse: UploadSessionResponse): UploadSession {\n    return {\n      id: apiResponse.id,\n      filename: apiResponse.filename,\n      fileSize: apiResponse.fileSize,\n      mimeType: apiResponse.mimeType,\n      status: this.mapApiStatusToLocal(apiResponse.status),\n      progress: apiResponse.progress,\n      startedAt: new Date(apiResponse.startedAt),\n      completedAt: apiResponse.completedAt ? new Date(apiResponse.completedAt) : undefined,\n      errorMessage: apiResponse.errorMessage,\n    };\n  }\n\n  /**\n   * Map API status to local status enum\n   */\n  private mapApiStatusToLocal(apiStatus: string): UploadStatus {\n    switch (apiStatus) {\n      case 'pending':\n        return UploadStatus.PENDING;\n      case 'uploading':\n        return UploadStatus.UPLOADING;\n      case 'processing':\n        return UploadStatus.PROCESSING;\n      case 'completed':\n        return UploadStatus.COMPLETED;\n      case 'failed':\n        return UploadStatus.FAILED;\n      default:\n        return UploadStatus.PENDING;\n    }\n  }\n\n  /**\n   * Subscribe to real-time upload progress updates via WebSocket\n   */\n  async subscribeToRealTimeUpdates(): Promise<void> {\n    try {\n      await aiRouterClient.connectWebSocket();\n\n      aiRouterClient.subscribeToUploadProgress((message) => {\n        const sessionId = message.sessionId;\n        const session = this.activeSessions.get(sessionId);\n\n        // Type guard for progress data\n        const data = message.data as { progress?: number };\n        if (session && typeof data.progress === 'number') {\n          const updatedSession = { ...session, progress: data.progress };\n          this.activeSessions.set(sessionId, updatedSession);\n          this.eventHandlers.onProgress?.(sessionId, data.progress);\n        }\n      });\n    } catch (error) {\n      console.error('Failed to subscribe to real-time updates:', error);\n    }\n  }\n\n  /**\n   * Unsubscribe from real-time updates\n   */\n  unsubscribeFromRealTimeUpdates(): void {\n    aiRouterClient.disconnectWebSocket();\n  }\n}\n\n/**\n * Default upload service instance\n */\nexport const uploadService = new UploadService();\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1549, "column": 0}, "map": {"version":3,"sources":["file:///Users/afos/Downloads/CtrlCheck-af-nonopen/proposal-prepper-web/src/components/analysis/types.ts"],"sourcesContent":["/*\n * SPDX-License-Identifier: AGPL-3.0-or-later\n * SPDX-FileCopyrightText: 2025 Seventeen Sierra LLC\n */\n\n/**\n * Analysis session status enumeration\n * Tracks the current state of document analysis\n */\nexport enum AnalysisStatus {\n  QUEUED = 'queued',\n  EXTRACTING = 'extracting',\n  ANALYZING = 'analyzing',\n  VALIDATING = 'validating',\n  COMPLETED = 'completed',\n  FAILED = 'failed',\n}\n\n/**\n * Analysis session interface\n * Represents an active analysis process\n */\nexport interface AnalysisSession {\n  id: string;\n  proposalId: string;\n  status: AnalysisStatus;\n  progress: number;\n  startedAt: Date;\n  completedAt?: Date;\n  estimatedCompletion?: Date;\n  currentStep: string;\n  errorMessage?: string;\n}\n\n/**\n * Compliance issue severity levels\n */\nexport enum IssueSeverity {\n  CRITICAL = 'critical',\n  WARNING = 'warning',\n  INFO = 'info',\n}\n\n/**\n * Compliance issue interface\n * Represents a specific compliance violation found during analysis\n */\nexport interface ComplianceIssue {\n  id: string;\n  severity: IssueSeverity;\n  title: string;\n  description: string;\n  regulation: string; // FAR/DFARS section reference\n  location?: {\n    page?: number;\n    section?: string;\n    lineNumber?: number;\n  };\n  remediation?: string;\n}\n\n/**\n * Analysis result interface\n * Contains the complete results of document analysis\n */\nexport interface AnalysisResult {\n  sessionId: string;\n  proposalId: string;\n  status: 'pass' | 'fail' | 'warning';\n  overallScore: number;\n  issues: ComplianceIssue[];\n  extractedText?: string;\n  analysisMetadata: {\n    totalPages: number;\n    processingTime: number;\n    rulesChecked: string[];\n    completedAt: Date;\n  };\n}\n\n/**\n * Text extraction result interface\n */\nexport interface TextExtractionResult {\n  success: boolean;\n  text?: string;\n  pageCount?: number;\n  errorMessage?: string;\n  metadata?: {\n    extractionMethod: string;\n    processingTime: number;\n    confidence: number;\n  };\n}\n\n/**\n * FAR/DFARS validation result interface\n */\nexport interface ValidationResult {\n  ruleId: string;\n  ruleName: string;\n  passed: boolean;\n  issues: ComplianceIssue[];\n  confidence: number;\n}\n"],"names":[],"mappings":"AAAA;;;CAGC,GAED;;;CAGC;;;;;;AACM,IAAA,AAAK,wCAAA;;;;;;;WAAA;;AA4BL,IAAA,AAAK,uCAAA;;;;WAAA"}},
    {"offset": {"line": 1580, "column": 0}, "map": {"version":3,"sources":["file:///Users/afos/Downloads/CtrlCheck-af-nonopen/proposal-prepper-services/src/ai-router-integration.ts"],"sourcesContent":["// SPDX-License-Identifier: AGPL-3.0-or-later\n// SPDX-FileCopyrightText: 2025 Seventeen Sierra LLC\n\n/**\n * AI Router Integration\n *\n * Provides high-level integration utilities for the AI routing service.s utilities for managing the integration between the web service\n * and the Strands service, including health monitoring, service discovery,\n * and error recovery.\n */\n\nimport { apiConfigManager } from '@/config/api-config';\nimport { AIRouterClient, aiRouterClient } from './ai-router-client';\n\n/**\n * Service integration status\n */\nexport interface ServiceIntegrationStatus {\n  connected: boolean;\n  healthy: boolean;\n  baseUrl: string;\n  lastChecked: number;\n  error?: string;\n  checks?: Record<string, string>;\n  version?: string;\n}\n\n/**\n * Service integration manager\n */\nexport class AIRouterIntegration {\n  private client: AIRouterClient;\n  private status: ServiceIntegrationStatus | null = null;\n  private statusListeners: Set<(status: ServiceIntegrationStatus) => void> = new Set();\n  private healthCheckInterval: NodeJS.Timeout | null = null;\n  private healthCheckIntervalMs = 30000; // 30 seconds\n\n  constructor(client: AIRouterClient = aiRouterClient) {\n    this.client = client;\n\n    // Listen for configuration changes\n    apiConfigManager.subscribe((config) => {\n      // Assuming AIRouterClient can be re-instantiated with a new base URL if needed\n      // Or, if it's a singleton, its internal config might need updating.\n      // For now, we'll assume it's re-instantiated if the config changes.\n      // This part of the original code was specific to StrandsApiClient and its baseUrl.\n      // If AIRouterClient doesn't have a baseUrl in the same way, this might need adjustment.\n      // Sticking to the provided diff, which doesn't explicitly change this line.\n      // However, the original `this.client = new StrandsApiClient(config.baseUrl);`\n      // implies `AIRouterClient` should also be able to take a `baseUrl`.\n      // Given the diff only changes the constructor signature, I'll keep the subscription logic as is,\n      // but it might be a logical inconsistency if AIRouterClient doesn't use baseUrl.\n      // For now, I'll assume `AIRouterClient` can be constructed with `config.baseUrl` if needed,\n      // or that `aiRouterClient` itself handles config updates.\n      // The diff does not explicitly change the body of the constructor beyond the signature.\n      // So, the original body remains, but `StrandsApiClient` becomes `AIRouterClient`.\n      this.client = new AIRouterClient(config.baseUrl); // Assuming AIRouterClient constructor takes baseUrl\n      this.checkServiceHealth();\n    });\n  }\n\n  /**\n   * Get the current Strands API client\n   */\n  getClient(): AIRouterClient {\n    return this.client;\n  }\n\n  /**\n   * Get current service integration status\n   */\n  getStatus(): ServiceIntegrationStatus | null {\n    return this.status;\n  }\n\n  /**\n   * Check service health and update status\n   */\n  async checkServiceHealth(): Promise<ServiceIntegrationStatus> {\n    try {\n      // Use getServiceStatus which exists on AIRouterClient\n      const serviceStatus = await this.client.getServiceStatus();\n\n      this.status = {\n        connected: true,\n        healthy: serviceStatus.healthy,\n        baseUrl: serviceStatus.baseUrl, // Assuming health status includes baseUrl\n        lastChecked: Date.now(),\n        error: serviceStatus.error,\n        checks: serviceStatus.checks,\n        version: serviceStatus.version,\n      };\n    } catch (error) {\n      this.status = {\n        connected: false,\n        healthy: false,\n        baseUrl: this.client.getBaseUrl(), // Assuming AIRouterClient has getBaseUrl\n        lastChecked: Date.now(),\n        error: error instanceof Error ? error.message : 'Unknown error',\n      };\n    }\n\n    // Notify listeners\n    this.notifyStatusListeners();\n    return this.status;\n  }\n\n  /**\n   * Start periodic health monitoring\n   */\n  startHealthMonitoring(): void {\n    if (this.healthCheckInterval) {\n      clearInterval(this.healthCheckInterval);\n    }\n\n    // Initial check\n    this.checkServiceHealth();\n\n    // Periodic checks\n    this.healthCheckInterval = setInterval(() => {\n      this.checkServiceHealth();\n    }, this.healthCheckIntervalMs);\n  }\n\n  /**\n   * Stop periodic health monitoring\n   */\n  stopHealthMonitoring(): void {\n    if (this.healthCheckInterval) {\n      clearInterval(this.healthCheckInterval);\n      this.healthCheckInterval = null;\n    }\n  }\n\n  /**\n   * Subscribe to status changes\n   */\n  subscribeToStatus(listener: (status: ServiceIntegrationStatus) => void): () => void {\n    this.statusListeners.add(listener);\n\n    // Send current status immediately if available\n    if (this.status) {\n      listener(this.status);\n    }\n\n    return () => this.statusListeners.delete(listener);\n  }\n\n  /**\n   * Notify all status listeners\n   */\n  private notifyStatusListeners(): void {\n    if (this.status) {\n      this.statusListeners.forEach((listener) => listener(this.status!));\n    }\n  }\n\n  /**\n   * Wait for service to become available\n   */\n  async waitForService(timeoutMs: number = 60000): Promise<boolean> {\n    const startTime = Date.now();\n\n    while (Date.now() - startTime < timeoutMs) {\n      await this.checkServiceHealth();\n\n      if (this.status?.healthy) {\n        return true;\n      }\n\n      // Wait before next check\n      await new Promise((resolve) => setTimeout(resolve, 2000));\n    }\n\n    return false;\n  }\n\n  /**\n   * Attempt to recover service connection\n   */\n  async recoverConnection(): Promise<boolean> {\n    // Try different base URLs if the current one fails\n    const fallbackUrls = [\n      'http://strands:8080', // Docker container name\n      'http://localhost:8080', // Local development\n      'http://127.0.0.1:8080', // Alternative localhost\n    ];\n\n    for (const url of fallbackUrls) {\n      try {\n        const testClient = new AIRouterClient(url);\n        const healthy = await testClient.isServiceHealthy();\n\n        if (healthy) {\n          // Update configuration to use this URL\n          apiConfigManager.updateConfiguration({ baseUrl: url });\n          await this.checkServiceHealth();\n          return true;\n        }\n      } catch (_error) { }\n    }\n\n    return false;\n  }\n\n  /**\n   * Get service readiness for operations\n   */\n  isReadyForOperations(): boolean {\n    return this.status?.healthy === true;\n  }\n\n  /**\n   * Get human-readable status message\n   */\n  getStatusMessage(): string {\n    if (!this.status) {\n      return 'Service status unknown';\n    }\n\n    if (this.status.healthy) {\n      return `Service healthy (${this.status.version || 'unknown version'})`;\n    }\n\n    if (this.status.connected) {\n      return `Service connected but unhealthy: ${this.status.error || 'Unknown issue'}`;\n    }\n\n    return `Service unavailable: ${this.status.error || 'Cannot connect'}`;\n  }\n}\n\n/**\n * Global service integration manager instance\n */\nexport const aiRouterIntegration = new AIRouterIntegration();\n\n/**\n * Utility functions for service integration\n */\nexport const AIRouterIntegrationUtils = {\n  /**\n   * Initialize service integration for the application\n   */\n  async initialize(): Promise<void> {\n    aiRouterIntegration.startHealthMonitoring();\n\n    // Wait for initial health check\n    await aiRouterIntegration.checkServiceHealth();\n  },\n\n  /**\n   * Cleanup service integration\n   */\n  cleanup(): void {\n    aiRouterIntegration.stopHealthMonitoring();\n  },\n\n  /**\n   * Check if service is ready and show user-friendly error if not\n   */\n  async ensureServiceReady(): Promise<{ ready: boolean; message?: string }> {\n    const status = await aiRouterIntegration.checkServiceHealth();\n\n    if (status.healthy) {\n      return { ready: true };\n    }\n\n    let message = 'The analysis service is currently unavailable.';\n\n    if (!status.connected) {\n      message += ' Please ensure the AI Router service is running.';\n    } else if (status.error) {\n      message += ` Error: ${status.error}`;\n    }\n\n    return { ready: false, message };\n  },\n\n  /**\n   * Get current service configuration\n   */\n  getServiceConfig(): { baseUrl: string; healthy: boolean; version?: string } {\n    const status = aiRouterIntegration.getStatus();\n    const client = aiRouterIntegration.getClient();\n\n    return {\n      baseUrl: client.getBaseUrl(),\n      healthy: status?.healthy || false,\n      version: status?.version,\n    };\n  },\n};\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1813, "column": 0}, "map": {"version":3,"sources":["file:///Users/afos/Downloads/CtrlCheck-af-nonopen/proposal-prepper-services/src/analysis-service.ts"],"sourcesContent":["// SPDX-License-Identifier: AGPL-3.0-or-later\n// SPDX-FileCopyrightText: 2025 Seventeen Sierra LLC\n\n/**\n * Analysis Service\n *\n * Service layer for managing compliance analysis and integrating with the Strands API.\n * Provides analysis session management, progress tracking, and results retrieval.\n * Implements requirements 2.1, 2.2, 2.3, 2.4, and 2.5 for analysis functionality.\n */\n\nimport { type AnalysisSession, AnalysisStatus } from '@/components/analysis/types';\nimport { analysisConfig } from '@/config/app';\nimport {\n  aiRouterClient,\n  type AnalysisSessionResponse,\n} from './ai-router-client';\nimport { AIRouterIntegrationUtils, aiRouterIntegration } from './ai-router-integration';\n\n/**\n * Analysis service events\n */\nexport interface AnalysisServiceEvents {\n  onProgress: (sessionId: string, progress: number, currentStep: string) => void;\n  onComplete: (sessionId: string, session: AnalysisSession) => void;\n  onError: (sessionId: string, error: string) => void;\n}\n\n/**\n * Analysis request parameters\n */\nexport interface AnalysisRequest {\n  proposalId: string;\n  documentId: string; // Added documentId\n  frameworks?: ('FAR' | 'DFARS')[];\n  options?: {\n    includeTextExtraction?: boolean;\n    includeCriticalValidation?: boolean;\n    includeWarningDetection?: boolean;\n  };\n}\n\n/**\n * Analysis Service Class\n *\n * Manages compliance analysis with the Strands API, providing session tracking,\n * progress monitoring, and results retrieval capabilities.\n */\nexport class AnalysisService {\n  private activeSessions = new Map<string, AnalysisSession>();\n  private eventHandlers: Partial<AnalysisServiceEvents> = {};\n\n  /**\n   * Set event handlers for analysis events\n   */\n  setEventHandlers(handlers: Partial<AnalysisServiceEvents>) {\n    this.eventHandlers = { ...this.eventHandlers, ...handlers };\n  }\n\n  /**\n   * Start compliance analysis\n   * Requirement 2.1: Validate against core FAR/DFARS requirements\n   * Requirement 2.4: Generate basic compliance status\n   */\n  async startAnalysis(\n    request: AnalysisRequest\n  ): Promise<{ success: boolean; sessionId: string; error?: string }> {\n    try {\n      // Check if service is ready before attempting analysis\n      const serviceReady = await AIRouterIntegrationUtils.ensureServiceReady();\n      if (!serviceReady.ready) {\n        return {\n          success: false,\n          sessionId: '',\n          error: serviceReady.message || 'Analysis service is not available',\n        };\n      }\n\n      // Start analysis with Strands API\n      const response = await aiRouterClient.startAnalysis(\n        request.proposalId,\n        request.proposalId, // Using proposalId as sessionId for now\n        request.documentId\n      );\n\n      if (response.success && response.data) {\n        // Create local session from API response\n        const session = this.mapApiResponseToSession(response.data);\n        this.activeSessions.set(session.id, session);\n\n        // Start progress monitoring\n        this.monitorAnalysisProgress(session.id);\n\n        return { success: true, sessionId: session.id };\n      } else {\n        const error = response.error || 'Failed to start analysis';\n        return { success: false, sessionId: '', error };\n      }\n    } catch (error) {\n      const errorMessage = error instanceof Error ? error.message : 'Analysis start failed';\n      return { success: false, sessionId: '', error: errorMessage };\n    }\n  }\n\n  /**\n   * Get analysis session status\n   * Requirement 2.4: Generate basic compliance status\n   */\n  async getAnalysisStatus(sessionId: string): Promise<AnalysisSession | null> {\n    // Check local session first\n    const localSession = this.activeSessions.get(sessionId);\n    if (localSession && localSession.status !== AnalysisStatus.COMPLETED) {\n      return localSession;\n    }\n\n    // Query server for latest status\n    try {\n      const response = await aiRouterClient.getAnalysisStatus(sessionId);\n      if (response.success && response.data) {\n        const session = this.mapApiResponseToSession(response.data);\n        this.activeSessions.set(sessionId, session);\n        return session;\n      }\n    } catch (error) {\n      console.error('Failed to get analysis status:', error);\n    }\n\n    return localSession || null;\n  }\n\n  /**\n   * Cancel analysis session\n   * Requirement 2.5: Error handling and recovery options\n   */\n  async cancelAnalysis(sessionId: string): Promise<boolean> {\n    try {\n      const response = await aiRouterClient.cancelAnalysis(sessionId);\n      if (response.success) {\n        const session = this.activeSessions.get(sessionId);\n        if (session) {\n          const cancelledSession = {\n            ...session,\n            status: AnalysisStatus.FAILED,\n            currentStep: 'Analysis cancelled',\n            errorMessage: 'Analysis cancelled by user',\n          };\n          this.activeSessions.set(sessionId, cancelledSession);\n        }\n        return true;\n      }\n    } catch (error) {\n      console.error('Failed to cancel analysis:', error);\n    }\n    return false;\n  }\n\n  /**\n   * Get all active analysis sessions\n   */\n  getActiveSessions(): AnalysisSession[] {\n    return Array.from(this.activeSessions.values());\n  }\n\n  /**\n   * Clear completed or failed sessions\n   */\n  clearSession(sessionId: string): boolean {\n    const session = this.activeSessions.get(sessionId);\n    if (\n      session &&\n      (session.status === AnalysisStatus.COMPLETED || session.status === AnalysisStatus.FAILED)\n    ) {\n      this.activeSessions.delete(sessionId);\n      return true;\n    }\n    return false;\n  }\n\n  /**\n   * Clear all sessions\n   */\n  clearAllSessions(): void {\n    this.activeSessions.clear();\n  }\n\n  /**\n   * Get Strands service status\n   */\n  async getServiceStatus(): Promise<{\n    healthy: boolean;\n    message: string;\n    baseUrl: string;\n    version?: string;\n  }> {\n    const _status = aiRouterIntegration.getStatus();\n    const config = AIRouterIntegrationUtils.getServiceConfig();\n\n    return {\n      healthy: config.healthy,\n      message: aiRouterIntegration.getStatusMessage(),\n      baseUrl: config.baseUrl,\n      version: config.version,\n    };\n  }\n\n  /**\n   * Initialize service integration\n   */\n  async initializeServiceIntegration(): Promise<void> {\n    await AIRouterIntegrationUtils.initialize();\n  }\n\n  /**\n   * Monitor analysis progress with polling\n   * Requirement 2.4: Analysis progress tracking\n   */\n  private async monitorAnalysisProgress(sessionId: string): Promise<void> {\n    const pollInterval = analysisConfig.progressUpdateInterval;\n    let attempts = 0;\n    const maxAttempts = Math.floor(analysisConfig.analysisTimeout / pollInterval);\n\n    const poll = async () => {\n      try {\n        const session = await this.getAnalysisStatus(sessionId);\n        if (!session) {\n          return; // Session not found, stop polling\n        }\n\n        // Notify progress\n        this.eventHandlers.onProgress?.(sessionId, session.progress, session.currentStep);\n\n        // Check if analysis is complete\n        if (session.status === AnalysisStatus.COMPLETED) {\n          this.eventHandlers.onComplete?.(sessionId, session);\n          return;\n        }\n\n        // Check if analysis failed\n        if (session.status === AnalysisStatus.FAILED) {\n          this.eventHandlers.onError?.(sessionId, session.errorMessage || 'Analysis failed');\n          return;\n        }\n\n        // Continue polling if still in progress\n        attempts++;\n        if (\n          attempts < maxAttempts &&\n          (session.status === AnalysisStatus.QUEUED ||\n            session.status === AnalysisStatus.EXTRACTING ||\n            session.status === AnalysisStatus.ANALYZING ||\n            session.status === AnalysisStatus.VALIDATING)\n        ) {\n          setTimeout(poll, pollInterval);\n        } else if (attempts >= maxAttempts) {\n          // Timeout\n          const timeoutSession = {\n            ...session,\n            status: AnalysisStatus.FAILED,\n            errorMessage: 'Analysis timeout',\n          };\n          this.activeSessions.set(sessionId, timeoutSession);\n          this.eventHandlers.onError?.(sessionId, 'Analysis timeout');\n        }\n      } catch (error) {\n        console.error('Error polling analysis progress:', error);\n        this.eventHandlers.onError?.(sessionId, 'Failed to monitor analysis progress');\n      }\n    };\n\n    // Start polling\n    setTimeout(poll, pollInterval);\n  }\n\n  /**\n   * Subscribe to real-time analysis progress updates via WebSocket\n   * Requirement 2.4: Real-time progress tracking\n   */\n  async subscribeToRealTimeUpdates(): Promise<void> {\n    try {\n      await aiRouterClient.connectWebSocket();\n\n      aiRouterClient.subscribeToAnalysisProgress((message: any) => {\n        const sessionId = message.sessionId;\n        const session = this.activeSessions.get(sessionId);\n\n        // Type guard for progress data\n        const data = message.data as { progress?: number; currentStep?: string };\n        if (session && typeof data.progress === 'number') {\n          const updatedSession = {\n            ...session,\n            progress: data.progress,\n            currentStep: data.currentStep || session.currentStep,\n          };\n          this.activeSessions.set(sessionId, updatedSession);\n          this.eventHandlers.onProgress?.(sessionId, data.progress, updatedSession.currentStep);\n        }\n      });\n\n      aiRouterClient.subscribeToAnalysisComplete((message) => {\n        const sessionId = message.sessionId;\n        const session = this.activeSessions.get(sessionId);\n\n        if (session) {\n          const completedSession = {\n            ...session,\n            status: AnalysisStatus.COMPLETED,\n            progress: 100,\n            completedAt: new Date(),\n          };\n          this.activeSessions.set(sessionId, completedSession);\n          this.eventHandlers.onComplete?.(sessionId, completedSession);\n        }\n      });\n\n      aiRouterClient.subscribeToErrors((message) => {\n        const sessionId = message.sessionId;\n        const session = this.activeSessions.get(sessionId);\n\n        if (session) {\n          // Type guard for error data\n          const data = message.data as { error?: string };\n          const failedSession = {\n            ...session,\n            status: AnalysisStatus.FAILED,\n            errorMessage: data.error || 'Analysis failed',\n          };\n          this.activeSessions.set(sessionId, failedSession);\n          this.eventHandlers.onError?.(sessionId, failedSession.errorMessage);\n        }\n      });\n    } catch (error) {\n      console.error('Failed to subscribe to real-time updates:', error);\n    }\n  }\n\n  /**\n   * Unsubscribe from real-time updates\n   */\n  unsubscribeFromRealTimeUpdates(): void {\n    aiRouterClient.disconnectWebSocket();\n  }\n\n  /**\n   * Validate analysis request parameters\n   * Requirement 2.1: FAR/DFARS validation framework\n   */\n  validateAnalysisRequest(request: AnalysisRequest): { isValid: boolean; error?: string } {\n    if (!request.proposalId || request.proposalId.trim().length === 0) {\n      return {\n        isValid: false,\n        error: 'Proposal ID is required for analysis',\n      };\n    }\n\n    if (request.proposalId.length > 128) {\n      return {\n        isValid: false,\n        error: 'Proposal ID is too long',\n      };\n    }\n\n    // Validate frameworks if specified\n    if (request.frameworks) {\n      const validFrameworks = ['FAR', 'DFARS'];\n      const invalidFrameworks = request.frameworks.filter((f) => !validFrameworks.includes(f));\n      if (invalidFrameworks.length > 0) {\n        return {\n          isValid: false,\n          error: `Invalid frameworks: ${invalidFrameworks.join(', ')}`,\n        };\n      }\n    }\n\n    return { isValid: true };\n  }\n\n  /**\n   * Retry failed analysis\n   * Requirement 2.5: Error recovery options\n   */\n  async retryAnalysis(\n    sessionId: string\n  ): Promise<{ success: boolean; newSessionId?: string; error?: string }> {\n    const session = this.activeSessions.get(sessionId);\n    if (!session) {\n      return { success: false, error: 'Session not found' };\n    }\n\n    if (session.status !== AnalysisStatus.FAILED) {\n      return { success: false, error: 'Can only retry failed analyses' };\n    }\n\n    // Start new analysis with same proposal ID\n    const request: AnalysisRequest = {\n      proposalId: session.proposalId,\n      documentId: session.proposalId, // Fallback to proposalId for retry\n      frameworks: ['FAR', 'DFARS'], // Default frameworks\n    };\n\n    const result = await this.startAnalysis(request);\n    if (result.success) {\n      // Clear old failed session\n      this.activeSessions.delete(sessionId);\n      return { success: true, newSessionId: result.sessionId };\n    }\n\n    return { success: false, error: result.error };\n  }\n\n  /**\n   * Map API response to internal session format\n   */\n  private mapApiResponseToSession(apiResponse: AnalysisSessionResponse): AnalysisSession {\n    return {\n      id: apiResponse.id,\n      proposalId: apiResponse.proposalId,\n      status: this.mapApiStatusToLocal(apiResponse.status),\n      progress: apiResponse.progress,\n      startedAt: new Date(apiResponse.startedAt),\n      completedAt: apiResponse.completedAt ? new Date(apiResponse.completedAt) : undefined,\n      currentStep: apiResponse.currentStep,\n      estimatedCompletion: apiResponse.estimatedCompletion\n        ? new Date(apiResponse.estimatedCompletion)\n        : undefined,\n    };\n  }\n\n  /**\n   * Map API status to local status enum\n   */\n  private mapApiStatusToLocal(apiStatus: string): AnalysisStatus {\n    switch (apiStatus) {\n      case 'queued':\n        return AnalysisStatus.QUEUED;\n      case 'extracting':\n        return AnalysisStatus.EXTRACTING;\n      case 'analyzing':\n        return AnalysisStatus.ANALYZING;\n      case 'validating':\n        return AnalysisStatus.VALIDATING;\n      case 'completed':\n        return AnalysisStatus.COMPLETED;\n      case 'failed':\n        return AnalysisStatus.FAILED;\n      default:\n        return AnalysisStatus.QUEUED;\n    }\n  }\n}\n\n/**\n * Default analysis service instance\n */\nexport const analysisService = new AnalysisService();\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 2193, "column": 0}, "map": {"version":3,"sources":["file:///Users/afos/Downloads/CtrlCheck-af-nonopen/proposal-prepper-web/src/components/results/types.ts"],"sourcesContent":["/*\n * SPDX-License-Identifier: AGPL-3.0-or-later\n * SPDX-FileCopyrightText: 2025 Seventeen Sierra LLC\n */\n\nimport { type ComplianceIssue, IssueSeverity } from '../analysis/types';\n\n/**\n * Results Presenter Type Definitions\n *\n * Types specific to the Results Presenter component for displaying\n * compliance analysis results, issues, and regulatory references.\n * Reuses ComplianceIssue and IssueSeverity from analysis module.\n */\n\n/**\n * Compliance status enumeration\n * Represents the overall compliance status of a proposal\n */\nexport enum ComplianceStatus {\n  PASS = 'pass',\n  FAIL = 'fail',\n  WARNING = 'warning',\n}\n\n// Re-export types from analysis module for convenience\nexport type { ComplianceIssue };\nexport { IssueSeverity };\n\n/**\n * Extended issue location interface\n * Extends the basic location with excerpt capability\n */\nexport interface ExtendedIssueLocation {\n  /** Page number where issue occurs */\n  page?: number;\n  /** Section identifier within the document */\n  section?: string;\n  /** Line number within the page/section */\n  lineNumber?: number;\n  /** Text excerpt showing the problematic content */\n  excerpt?: string;\n}\n\n/**\n * Extended compliance issue interface\n * Extends the basic ComplianceIssue with additional location details\n */\nexport interface ExtendedComplianceIssue extends Omit<ComplianceIssue, 'location'> {\n  /** Extended location information within the document */\n  location?: ExtendedIssueLocation;\n}\n\n/**\n * Analysis results interface\n * Contains the complete results of compliance analysis\n */\nexport interface AnalysisResults {\n  /** Unique identifier for the analysis session */\n  sessionId: string;\n  /** Reference to the analyzed proposal */\n  proposalId: string;\n  /** Overall compliance status */\n  status: ComplianceStatus;\n  /** Overall compliance score (0-100) */\n  overallScore: number;\n  /** List of identified compliance issues */\n  issues: ExtendedComplianceIssue[];\n  /** Analysis metadata and statistics */\n  metadata: AnalysisMetadata;\n}\n\n/**\n * Analysis metadata interface\n * Contains statistical and processing information about the analysis\n */\nexport interface AnalysisMetadata {\n  /** Total number of pages analyzed */\n  totalPages: number;\n  /** Processing time in milliseconds */\n  processingTime: number;\n  /** List of regulatory rules that were checked */\n  rulesChecked: string[];\n  /** Timestamp when analysis completed */\n  completedAt: Date;\n  /** Number of issues by severity */\n  issueCounts: {\n    critical: number;\n    warning: number;\n    info: number;\n  };\n}\n\n/**\n * Results presenter props interface\n * Props for the main Results Presenter component\n */\nexport interface ResultsPresenterProps {\n  /** Analysis results to display */\n  results?: AnalysisResults;\n  /** Loading state indicator */\n  isLoading?: boolean;\n  /** Error message if results failed to load */\n  error?: string;\n  /** Callback when user requests to view issue details */\n  onViewIssueDetails?: (issueId: string) => void;\n  /** Callback when user requests to download results */\n  onDownloadResults?: () => void;\n  /** Callback when user wants to start a new analysis */\n  onStartNewAnalysis?: () => void;\n}\n\n/**\n * Issue list props interface\n * Props for the compliance issues list component\n */\nexport interface IssueListProps {\n  /** List of compliance issues to display */\n  issues: ExtendedComplianceIssue[];\n  /** Callback when user clicks on an issue */\n  onIssueClick?: (issueId: string) => void;\n  /** Whether to show detailed information */\n  showDetails?: boolean;\n}\n\n/**\n * Status display props interface\n * Props for the compliance status display component\n */\nexport interface StatusDisplayProps {\n  /** Overall compliance status */\n  status: ComplianceStatus;\n  /** Overall compliance score */\n  score: number;\n  /** Issue counts by severity */\n  issueCounts: AnalysisMetadata['issueCounts'];\n  /** Whether to show detailed statistics */\n  showDetails?: boolean;\n}\n"],"names":[],"mappings":"AAAA;;;CAGC;;;;AAED;;AAcO,IAAA,AAAK,0CAAA;;;;WAAA"}},
    {"offset": {"line": 2213, "column": 0}, "map": {"version":3,"sources":["file:///Users/afos/Downloads/CtrlCheck-af-nonopen/proposal-prepper-services/src/results-service.ts"],"sourcesContent":["// SPDX-License-Identifier: AGPL-3.0-or-later\n// SPDX-FileCopyrightText: 2025 Seventeen Sierra LLC\n\n/**\n * Results Service\n *\n * Service layer for managing compliance analysis results and integrating with the Strands API.\n * Provides results retrieval, issue details, and regulatory references.\n * Implements requirements 3.1, 3.2, 3.3, 3.4, and 3.5 for results functionality.\n */\n\nimport {\n  type AnalysisResults,\n  ComplianceStatus,\n  IssueSeverity,\n  type ComplianceIssue as LocalComplianceIssue,\n} from '@/components/results/types';\nimport type {\n  ComplianceIssue,\n  ComplianceResultsResponse,\n} from './ai-router-client';\nimport { aiRouterClient } from './ai-router-client';\n\n/**\n * Results service events\n */\nexport interface ResultsServiceEvents {\n  onResultsUpdate: (proposalId: string, results: AnalysisResults) => void;\n  onError: (proposalId: string, error: string) => void;\n}\n\n/**\n * Results Service Class\n *\n * Manages compliance analysis results with the Strands API, providing results retrieval,\n * issue details, and regulatory reference capabilities.\n */\nexport class ResultsService {\n  private resultsCache = new Map<string, AnalysisResults>();\n  private eventHandlers: Partial<ResultsServiceEvents> = {};\n\n  /**\n   * Set event handlers for results events\n   */\n  setEventHandlers(handlers: Partial<ResultsServiceEvents>) {\n    this.eventHandlers = { ...this.eventHandlers, ...handlers };\n  }\n\n  /**\n   * Get compliance analysis results\n   * Requirement 3.1: Show compliance status (pass/fail/warning)\n   * Requirement 3.2: List identified compliance issues\n   */\n  async getResults(\n    proposalId: string,\n    useCache: boolean = true\n  ): Promise<{ success: boolean; results?: AnalysisResults; error?: string }> {\n    // Check cache first if requested\n    if (useCache && this.resultsCache.has(proposalId)) {\n      const cachedResults = this.resultsCache.get(proposalId)!;\n      return { success: true, results: cachedResults };\n    }\n\n    try {\n      const response = await aiRouterClient.getResults(proposalId);\n\n      if (response.success && response.data) {\n        const results = this.mapApiResponseToResults(response.data);\n\n        // Cache the results\n        this.resultsCache.set(proposalId, results);\n\n        // Notify listeners\n        this.eventHandlers.onResultsUpdate?.(proposalId, results);\n\n        return { success: true, results };\n      } else {\n        const error = response.error || 'Failed to retrieve results';\n        this.eventHandlers.onError?.(proposalId, error);\n        return { success: false, error };\n      }\n    } catch (error) {\n      const errorMessage = error instanceof Error ? error.message : 'Results retrieval failed';\n      this.eventHandlers.onError?.(proposalId, errorMessage);\n      return { success: false, error: errorMessage };\n    }\n  }\n\n  /**\n   * Get specific compliance issue details\n   * Requirement 3.5: Allow users to see specific issue locations\n   */\n  async getIssueDetails(\n    sessionId: string,\n    issueId: string\n  ): Promise<{ success: boolean; issue?: ComplianceIssue; error?: string }> {\n    try {\n      const response = await aiRouterClient.getIssueDetails(issueId);\n\n      if (response.success && response.data) {\n        return { success: true, issue: response.data };\n      } else {\n        const error = response.error || 'Failed to retrieve issue details';\n        return { success: false, error };\n      }\n    } catch (error) {\n      const errorMessage =\n        error instanceof Error ? error.message : 'Issue details retrieval failed';\n      return { success: false, error: errorMessage };\n    }\n  }\n\n  /**\n   * Get regulatory references for issues\n   * Requirement 3.4: Reference specific FAR/DFARS sections\n   */\n  getRegulatoryReferences(\n    results: AnalysisResults\n  ): { framework: string; sections: string[]; count: number }[] {\n    const references = new Map<string, Set<string>>();\n\n    // Collect all regulatory references from issues\n    results.issues.forEach((issue: LocalComplianceIssue) => {\n      if (issue.regulation) {\n        // Extract framework (FAR, DFARS) and section from regulation\n        const parts = issue.regulation.split(' ');\n        const framework = parts[0]; // e.g., \"FAR\" or \"DFARS\"\n        const section = parts.slice(1).join(' '); // e.g., \"52.204-1\"\n\n        if (!references.has(framework)) {\n          references.set(framework, new Set());\n        }\n        references.get(framework)!.add(section);\n      }\n    });\n\n    // Convert to array format\n    return Array.from(references.entries()).map(([framework, sections]) => ({\n      framework,\n      sections: Array.from(sections).sort(),\n      count: sections.size,\n    }));\n  }\n\n  /**\n   * Get remediation guidance for issues\n   * Requirement 3.3: Include basic remediation recommendations\n   */\n  getRemediationGuidance(issueId: string, results?: AnalysisResults): string | null {\n    if (!results) return null;\n\n    const issue = results.issues.find((i: LocalComplianceIssue) => i.id === issueId);\n    if (!issue || !issue.remediation) return null;\n\n    return issue.remediation;\n  }\n\n  /**\n   * Filter issues by severity\n   */\n  filterIssuesBySeverity(\n    results: AnalysisResults,\n    severity: IssueSeverity\n  ): LocalComplianceIssue[] {\n    return results.issues.filter((issue: LocalComplianceIssue) => issue.severity === severity);\n  }\n\n  /**\n   * Get issue statistics\n   */\n  getIssueStatistics(results: AnalysisResults): {\n    total: number;\n    critical: number;\n    warning: number;\n    info: number;\n    byFramework: { framework: string; count: number }[];\n  } {\n    const stats = {\n      total: results.issues.length,\n      critical: 0,\n      warning: 0,\n      info: 0,\n      byFramework: [] as { framework: string; count: number }[],\n    };\n\n    const frameworkCounts = new Map<string, number>();\n\n    results.issues.forEach((issue: LocalComplianceIssue) => {\n      // Count by severity\n      switch (issue.severity) {\n        case IssueSeverity.CRITICAL:\n          stats.critical++;\n          break;\n        case IssueSeverity.WARNING:\n          stats.warning++;\n          break;\n        case IssueSeverity.INFO:\n          stats.info++;\n          break;\n      }\n\n      // Count by framework\n      if (issue.regulation) {\n        // Extract framework (FAR, DFARS) from regulation\n        const framework = issue.regulation.split(' ')[0]; // e.g., \"FAR\" or \"DFARS\"\n        frameworkCounts.set(framework, (frameworkCounts.get(framework) || 0) + 1);\n      }\n    });\n\n    // Convert framework counts to array\n    stats.byFramework = Array.from(frameworkCounts.entries()).map(([framework, count]) => ({\n      framework,\n      count,\n    }));\n\n    return stats;\n  }\n\n  /**\n   * Export results to different formats\n   */\n  async exportResults(\n    proposalId: string,\n    format: 'json' | 'csv' | 'pdf' = 'json'\n  ): Promise<{ success: boolean; data?: string | Blob; error?: string }> {\n    const resultsResponse = await this.getResults(proposalId);\n\n    if (!resultsResponse.success || !resultsResponse.results) {\n      return { success: false, error: resultsResponse.error || 'No results to export' };\n    }\n\n    const results = resultsResponse.results;\n\n    try {\n      switch (format) {\n        case 'json':\n          return {\n            success: true,\n            data: JSON.stringify(results, null, 2),\n          };\n\n        case 'csv': {\n          const csvData = this.convertToCSV(results);\n          return {\n            success: true,\n            data: csvData,\n          };\n        }\n\n        case 'pdf':\n          // For threshold implementation, return JSON format\n          // In full implementation, this would generate a PDF\n          return {\n            success: true,\n            data: JSON.stringify(results, null, 2),\n          };\n\n        default:\n          return { success: false, error: 'Unsupported export format' };\n      }\n    } catch (error) {\n      const errorMessage = error instanceof Error ? error.message : 'Export failed';\n      return { success: false, error: errorMessage };\n    }\n  }\n\n  /**\n   * Clear cached results\n   */\n  clearCache(proposalId?: string): void {\n    if (proposalId) {\n      this.resultsCache.delete(proposalId);\n    } else {\n      this.resultsCache.clear();\n    }\n  }\n\n  /**\n   * Get cached results\n   */\n  getCachedResults(proposalId: string): AnalysisResults | null {\n    return this.resultsCache.get(proposalId) || null;\n  }\n\n  /**\n   * Check if results are available for a proposal\n   */\n  async hasResults(proposalId: string): Promise<boolean> {\n    // Check cache first\n    if (this.resultsCache.has(proposalId)) {\n      return true;\n    }\n\n    // Check with API\n    try {\n      const response = await aiRouterClient.getResults(proposalId);\n      return response.success && !!response.data;\n    } catch {\n      return false;\n    }\n  }\n\n  /**\n   * Convert results to CSV format\n   */\n  private convertToCSV(results: AnalysisResults): string {\n    const headers = [\n      'Issue ID',\n      'Severity',\n      'Title',\n      'Description',\n      'Framework',\n      'Section',\n      'Reference',\n      'Remediation',\n    ];\n    const rows = [headers.join(',')];\n\n    results.issues.forEach((issue: LocalComplianceIssue) => {\n      const row = [\n        issue.id,\n        issue.severity,\n        `\"${issue.title.replace(/\"/g, '\"\"')}\"`,\n        `\"${issue.description.replace(/\"/g, '\"\"')}\"`,\n        issue.regulation || '',\n        issue.regulation || '',\n        issue.regulation || '',\n        issue.remediation ? `\"${issue.remediation.replace(/\"/g, '\"\"')}\"` : '',\n      ];\n      rows.push(row.join(','));\n    });\n\n    return rows.join('\\n');\n  }\n\n  /**\n   * Map API response to internal results format\n   */\n  private mapApiResponseToResults(apiResponse: ComplianceResultsResponse): AnalysisResults {\n    return {\n      sessionId: apiResponse.id,\n      proposalId: apiResponse.proposalId,\n      status: this.mapApiStatusToLocal(apiResponse.status),\n      overallScore: this.calculateOverallScore(apiResponse.issues),\n      issues: apiResponse.issues.map(this.mapApiIssueToLocal),\n      metadata: {\n        totalPages: 1, // Default, would be provided by API in full implementation\n        processingTime: 0, // Default, would be provided by API\n        rulesChecked: this.extractRulesChecked(apiResponse.issues),\n        completedAt: new Date(apiResponse.generatedAt),\n        issueCounts: {\n          critical: apiResponse.summary.criticalIssues,\n          warning: apiResponse.summary.warningIssues,\n          info:\n            apiResponse.summary.totalIssues -\n            apiResponse.summary.criticalIssues -\n            apiResponse.summary.warningIssues,\n        },\n      },\n    };\n  }\n\n  /**\n   * Map API status to local status enum\n   */\n  private mapApiStatusToLocal(apiStatus: string): ComplianceStatus {\n    switch (apiStatus) {\n      case 'pass':\n        return ComplianceStatus.PASS;\n      case 'fail':\n        return ComplianceStatus.FAIL;\n      case 'warning':\n        return ComplianceStatus.WARNING;\n      default:\n        return ComplianceStatus.WARNING;\n    }\n  }\n\n  /**\n   * Map API issue to local issue format\n   */\n  private mapApiIssueToLocal = (apiIssue: ComplianceIssue): LocalComplianceIssue => {\n    return {\n      id: apiIssue.id,\n      severity: this.mapApiSeverityToLocal(apiIssue.severity),\n      title: apiIssue.title,\n      description: apiIssue.description,\n      regulation: apiIssue.regulation ? apiIssue.regulation.reference : '',\n      location: apiIssue.location\n        ? {\n          page: apiIssue.location.page,\n          section: apiIssue.location.section,\n          lineNumber: 0, // Default line number since API has 'text' but local expects 'lineNumber'\n        }\n        : undefined,\n      remediation: apiIssue.remediation,\n    };\n  };\n\n  /**\n   * Map API severity to local severity enum\n   */\n  private mapApiSeverityToLocal(apiSeverity: string): IssueSeverity {\n    switch (apiSeverity) {\n      case 'critical':\n        return IssueSeverity.CRITICAL;\n      case 'warning':\n        return IssueSeverity.WARNING;\n      case 'info':\n        return IssueSeverity.INFO;\n      default:\n        return IssueSeverity.INFO;\n    }\n  }\n\n  /**\n   * Calculate overall score from issues\n   */\n  private calculateOverallScore(issues: ComplianceIssue[]): number {\n    if (issues.length === 0) return 100;\n\n    const criticalPenalty = issues.filter((i) => i.severity === 'critical').length * 20;\n    const warningPenalty = issues.filter((i) => i.severity === 'warning').length * 10;\n    const infoPenalty = issues.filter((i) => i.severity === 'info').length * 5;\n\n    const totalPenalty = criticalPenalty + warningPenalty + infoPenalty;\n    return Math.max(0, 100 - totalPenalty);\n  }\n\n  /**\n   * Extract rules checked from issues\n   */\n  private extractRulesChecked(issues: ComplianceIssue[]): string[] {\n    const rules = new Set<string>();\n    issues.forEach((issue) => {\n      if (issue.regulation) {\n        rules.add(issue.regulation.reference);\n      }\n    });\n    return Array.from(rules);\n  }\n}\n\n/**\n * Default results service instance\n */\nexport const resultsService = new ResultsService();\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 2589, "column": 0}, "map": {"version":3,"sources":["file:///Users/afos/Downloads/CtrlCheck-af-nonopen/proposal-prepper-web/src/components/agent-interface.tsx"],"sourcesContent":["'use client';\n\nimport { Bot, CheckCircle2, FileCheck, Loader2, Send, Sparkles, Upload, Zap, AlertCircle } from 'lucide-react';\nimport { useCallback, useEffect, useRef, useState } from 'react';\nimport { Button, Textarea } from '@/components/ui';\nimport { uploadService } from 'proposal-prepper-services/upload-service';\nimport { analysisService } from 'proposal-prepper-services/analysis-service';\nimport { resultsService } from 'proposal-prepper-services/results-service';\nimport { AnalysisStatus } from '@/components/analysis/types';\nimport type { AnalysisResults } from '@/components/results/types';\n\ntype Step = {\n  id: number;\n  message: string;\n  status: 'pending' | 'running' | 'complete' | 'error';\n  agent?: 'coordinator' | 'rag' | 'compliance' | 'writer';\n  details?: string;\n};\n\ntype Message = {\n  role: 'user' | 'bot';\n  content: string;\n};\n\ntype AgentInterfaceProps = {\n  activeProject: string | null;\n  onAnalysisStart: () => void;\n  onAnalysisComplete: (results: AnalysisResults) => void;\n  onAnalysisError: (error: string) => void;\n};\n\n// Map analysis status to step information\nconst analysisSteps: Step[] = [\n  {\n    id: 1,\n    message: 'Uploading and processing document...',\n    status: 'pending',\n    agent: 'coordinator',\n    details: 'Document Upload',\n  },\n  {\n    id: 2,\n    message: 'Extracting document structure and text...',\n    status: 'pending',\n    agent: 'rag',\n    details: 'Text Extraction',\n  },\n  {\n    id: 3,\n    message: 'Validating against FAR/DFARS requirements...',\n    status: 'pending',\n    agent: 'compliance',\n    details: 'Compliance Analysis',\n  },\n  {\n    id: 4,\n    message: 'Checking regulatory clause compliance...',\n    status: 'pending',\n    agent: 'compliance',\n    details: 'Validation Check',\n  },\n  {\n    id: 5,\n    message: 'Synthesizing compliance report...',\n    status: 'pending',\n    agent: 'writer',\n    details: 'Report Generation',\n  },\n];\n\n// Map AnalysisStatus to step index\nfunction getStepIndexFromStatus(status: AnalysisStatus): number {\n  switch (status) {\n    case AnalysisStatus.QUEUED:\n      return 0;\n    case AnalysisStatus.EXTRACTING:\n      return 1;\n    case AnalysisStatus.ANALYZING:\n      return 2;\n    case AnalysisStatus.VALIDATING:\n      return 3;\n    case AnalysisStatus.COMPLETED:\n      return 4;\n    case AnalysisStatus.FAILED:\n      return -1;\n    default:\n      return 0;\n  }\n}\n\nconst AgentInterface = ({ activeProject, onAnalysisStart, onAnalysisComplete, onAnalysisError }: AgentInterfaceProps) => {\n  const [activeTab, setActiveTab] = useState<'steps' | 'results'>('steps');\n  const [steps, setSteps] = useState<Step[]>([]);\n  const [messages, setMessages] = useState<Message[]>([]);\n  const [inputValue, setInputValue] = useState('');\n  const [isSending, setIsSending] = useState(false);\n  const [isAnalysisComplete, setIsAnalysisComplete] = useState(false);\n  const [selectedFile, setSelectedFile] = useState<File | null>(null);\n  const [isUploading, setIsUploading] = useState(false);\n  const [uploadError, setUploadError] = useState<string | null>(null);\n  const [analysisSessionId, setAnalysisSessionId] = useState<string | null>(null);\n  const messagesEndRef = useRef<HTMLDivElement>(null);\n  const fileInputRef = useRef<HTMLInputElement>(null);\n\n  const scrollToBottom = useCallback(() => {\n    messagesEndRef.current?.scrollIntoView({ behavior: 'smooth' });\n  }, []);\n\n  useEffect(() => {\n    scrollToBottom();\n  }, [scrollToBottom]);\n\n  // Handle file selection\n  const handleFileSelect = (event: React.ChangeEvent<HTMLInputElement>) => {\n    const file = event.target.files?.[0];\n    if (file) {\n      // Validate file\n      const validation = uploadService.validateFile(file);\n      if (!validation.isValid) {\n        setUploadError(validation.error || 'Invalid file');\n        return;\n      }\n      setSelectedFile(file);\n      setUploadError(null);\n    }\n  };\n\n  // Handle upload and analysis\n  const handleUploadAndAnalyze = async () => {\n    if (!selectedFile) return;\n\n    setIsUploading(true);\n    setUploadError(null);\n    setSteps(analysisSteps.map(step => ({ ...step, status: 'pending' })));\n    setIsAnalysisComplete(false);\n    setMessages([]);\n\n    // Notify parent that analysis is starting\n    onAnalysisStart();\n\n    try {\n      // Step 1: Upload document\n      setSteps(prev => prev.map((step, idx) =>\n        idx === 0 ? { ...step, status: 'running' } : step\n      ));\n\n      const uploadResult = await uploadService.uploadDocument(selectedFile);\n\n      if (!uploadResult.success) {\n        throw new Error(uploadResult.error || 'Upload failed');\n      }\n\n      // Mark upload complete, start analysis\n      setSteps(prev => prev.map((step, idx) =>\n        idx === 0 ? { ...step, status: 'complete' } :\n          idx === 1 ? { ...step, status: 'running' } : step\n      ));\n\n      // Step 2-5: Start analysis\n      const analysisResult = await analysisService.startAnalysis({\n        proposalId: uploadResult.sessionId,\n        documentId: uploadResult.sessionId,\n        frameworks: ['FAR', 'DFARS'],\n      });\n\n      if (!analysisResult.success) {\n        throw new Error(analysisResult.error || 'Analysis failed to start');\n      }\n\n      setAnalysisSessionId(analysisResult.sessionId);\n\n      // Set up event handlers for progress updates\n      analysisService.setEventHandlers({\n        onProgress: (sessionId, progress, currentStep) => {\n          // Update steps based on current step info\n          const session = analysisService.getActiveSessions().find(s => s.id === sessionId);\n          if (session) {\n            const stepIndex = getStepIndexFromStatus(session.status);\n            setSteps(prev => prev.map((step, idx) => {\n              if (idx < stepIndex) return { ...step, status: 'complete' };\n              if (idx === stepIndex) return { ...step, status: 'running' };\n              return step;\n            }));\n          }\n        },\n        onComplete: async (sessionId, session) => {\n          // Mark all steps complete\n          setSteps(prev => prev.map(step => ({ ...step, status: 'complete' })));\n          setIsAnalysisComplete(true);\n          setIsUploading(false);\n\n          // Fetch results\n          try {\n            // Use sessionId (Analysis Session ID) not proposalId\n            const resultsResponse = await resultsService.getResults(sessionId);\n            if (resultsResponse.success && resultsResponse.results) {\n              const results = resultsResponse.results;\n              const issueCount = results.issues.length;\n              const criticalCount = results.issues.filter(i => i.severity === 'critical').length;\n\n              setMessages([{\n                role: 'bot',\n                content: `Analysis complete. I found ${issueCount} compliance issue${issueCount !== 1 ? 's' : ''} (${criticalCount} critical). The proposal has a ${results.overallScore}% compliance score. You can view the full details in the report panel.`,\n              }]);\n              setActiveTab('results');\n\n              // Notify parent with the results\n              onAnalysisComplete(results);\n            }\n          } catch (err) {\n            console.error('Failed to fetch results:', err);\n            onAnalysisError('Failed to fetch analysis results');\n          }\n        },\n        onError: (sessionId, error) => {\n          setSteps(prev => prev.map((step, idx) => {\n            const runningIdx = prev.findIndex(s => s.status === 'running');\n            if (idx === runningIdx || (runningIdx === -1 && idx === prev.length - 1)) {\n              return { ...step, status: 'error' };\n            }\n            return step;\n          }));\n          setUploadError(error);\n          setIsUploading(false);\n          onAnalysisError(error);\n        },\n      });\n\n      // Start monitoring (polling for progress)\n      // The analysis service handles this internally\n\n    } catch (error) {\n      const errorMessage = error instanceof Error ? error.message : 'An error occurred';\n      setUploadError(errorMessage);\n      setSteps(prev => prev.map((step, idx) => {\n        if (step.status === 'running') return { ...step, status: 'error' };\n        return step;\n      }));\n      setIsUploading(false);\n      onAnalysisError(errorMessage);\n    }\n  };\n\n  const handleSendMessage = async () => {\n    if (!inputValue.trim()) return;\n\n    const userMessage: Message = { role: 'user', content: inputValue };\n    setMessages((prev) => [...prev, userMessage]);\n    setInputValue('');\n    setIsSending(true);\n\n    // For now, provide a contextual response\n    // In full implementation, this would query an AI for follow-up questions\n    setTimeout(() => {\n      const botMessage: Message = {\n        role: 'bot',\n        content:\n          \"I can help you understand the compliance findings. Ask me about specific FAR/DFARS clauses, remediation steps, or how to address the identified issues.\",\n      };\n      setMessages((prev) => [...prev, botMessage]);\n      setIsSending(false);\n    }, 1000);\n  };\n\n  const getAgentIcon = (agent: string) => {\n    switch (agent) {\n      case 'coordinator':\n        return <Zap size={14} className=\"text-blue-500\" />;\n      case 'rag':\n        return <SearchIcon size={14} className=\"text-purple-500\" />;\n      case 'compliance':\n        return <CheckCircle2 size={14} className=\"text-green-500\" />;\n      case 'writer':\n        return <FileCheck size={14} className=\"text-orange-500\" />;\n      default:\n        return <Bot size={14} className=\"text-gray-500\" />;\n    }\n  };\n\n  // Helper for SearchIcon\n  const SearchIcon = ({ size, className }: { size: number; className: string }) => (\n    <svg\n      xmlns=\"http://www.w3.org/2000/svg\"\n      width={size}\n      height={size}\n      viewBox=\"0 0 24 24\"\n      fill=\"none\"\n      stroke=\"currentColor\"\n      strokeWidth=\"2\"\n      strokeLinecap=\"round\"\n      strokeLinejoin=\"round\"\n      className={className}\n      aria-label=\"Search\"\n    >\n      <circle cx=\"11\" cy=\"11\" r=\"8\" />\n      <path d=\"m21 21-4.3-4.3\" />\n    </svg>\n  );\n\n  const getStepIcon = (status: Step['status']) => {\n    switch (status) {\n      case 'complete':\n        return <CheckCircle2 size={20} className=\"text-green-500\" />;\n      case 'running':\n        return <Loader2 size={20} className=\"text-blue-500 animate-spin\" />;\n      case 'error':\n        return <AlertCircle size={20} className=\"text-red-500\" />;\n      default:\n        return <div className=\"w-5 h-5 rounded-full border-2 border-gray-200\" />;\n    }\n  };\n\n  return (\n    <div className=\"flex-1 flex flex-col h-full bg-white relative\">\n      <div className=\"flex-1 overflow-y-auto scrollbar-hide p-6\">\n        <div className=\"max-w-3xl mx-auto w-full space-y-8\">\n          {!activeProject && (\n            <div className=\"text-center py-20 animate-in fade-in slide-in-from-bottom-4 duration-700\">\n              <div className=\"bg-blue-50 w-24 h-24 rounded-3xl mx-auto mb-8 flex items-center justify-center text-blue-600 shadow-sm\">\n                <Sparkles size={40} />\n              </div>\n              <h2 className=\"text-3xl font-bold text-slate-900 mb-3 tracking-tight\">\n                AI Regulatory Assistant\n              </h2>\n              <p className=\"text-gray-500 max-w-md mx-auto mb-10 text-lg leading-relaxed\">\n                Upload your proposal to analyze against FAR/DFARS requirements using our multi-agent compliance engine.\n              </p>\n\n              {/* File Upload Section */}\n              <div className=\"flex flex-col items-center gap-4 max-w-md mx-auto\">\n                <input\n                  ref={fileInputRef}\n                  type=\"file\"\n                  accept=\".pdf,application/pdf\"\n                  onChange={handleFileSelect}\n                  className=\"hidden\"\n                />\n\n                <button\n                  type=\"button\"\n                  onClick={() => fileInputRef.current?.click()}\n                  className=\"flex items-center gap-4 p-5 rounded-xl border border-gray-200 hover:border-blue-300 hover:shadow-md hover:bg-blue-50/30 transition-all group bg-white w-full\"\n                >\n                  <div className=\"p-3 bg-blue-100 text-blue-600 rounded-lg group-hover:scale-110 transition-transform\">\n                    <Upload size={24} />\n                  </div>\n                  <div className=\"text-left\">\n                    <div className=\"font-semibold text-slate-800 text-base\">\n                      {selectedFile ? selectedFile.name : 'Select Proposal PDF'}\n                    </div>\n                    <p className=\"text-sm text-gray-500 mt-1 leading-relaxed\">\n                      {selectedFile\n                        ? `${(selectedFile.size / 1024 / 1024).toFixed(2)} MB`\n                        : 'Upload a PDF document for compliance analysis'\n                      }\n                    </p>\n                  </div>\n                </button>\n\n                {uploadError && (\n                  <div className=\"flex items-center gap-2 text-red-600 text-sm bg-red-50 p-3 rounded-lg w-full\">\n                    <AlertCircle size={16} />\n                    {uploadError}\n                  </div>\n                )}\n\n                {selectedFile && (\n                  <Button\n                    onClick={handleUploadAndAnalyze}\n                    disabled={isUploading}\n                    className=\"w-full bg-blue-600 hover:bg-blue-700 text-white py-3\"\n                  >\n                    {isUploading ? (\n                      <>\n                        <Loader2 size={16} className=\"animate-spin mr-2\" />\n                        Analyzing...\n                      </>\n                    ) : (\n                      <>\n                        <FileCheck size={16} className=\"mr-2\" />\n                        Start Compliance Analysis\n                      </>\n                    )}\n                  </Button>\n                )}\n              </div>\n            </div>\n          )}\n\n          {activeProject && (\n            <div className=\"flex flex-col h-full\">\n              <div className=\"flex border-b border-gray-200 mb-6 bg-white sticky top-0 z-10 pt-2\">\n                <button\n                  type=\"button\"\n                  onClick={() => setActiveTab('steps')}\n                  className={`pb-3 px-1 text-sm font-medium mr-6 transition-colors border-b-2 ${activeTab === 'steps'\n                    ? 'text-blue-600 border-blue-600'\n                    : 'text-gray-500 border-transparent hover:text-slate-800'\n                    }`}\n                >\n                  Live Analysis\n                </button>\n                <button\n                  type=\"button\"\n                  onClick={() => setActiveTab('results')}\n                  className={`pb-3 px-1 text-sm font-medium transition-colors border-b-2 ${activeTab === 'results'\n                    ? 'text-blue-600 border-blue-600'\n                    : 'text-gray-500 border-transparent hover:text-slate-800'\n                    }`}\n                >\n                  Results & Chat\n                </button>\n              </div>\n\n              {activeTab === 'steps' && (\n                <div className=\"space-y-4 animate-in fade-in duration-300\">\n                  {steps.map((step) => (\n                    <div\n                      key={step.id}\n                      className={`flex gap-3 p-4 rounded-xl border transition-all ${step.status === 'running' ? 'bg-blue-50/50 border-blue-100 shadow-sm' :\n                        step.status === 'error' ? 'bg-red-50/50 border-red-100' :\n                          'bg-white border-gray-100'\n                        }`}\n                    >\n                      <div className=\"mt-1 shrink-0\">\n                        {getStepIcon(step.status)}\n                      </div>\n                      <div className=\"flex-1\">\n                        <div className=\"flex items-center gap-2 mb-1\">\n                          {getAgentIcon(step.agent || 'coordinator')}\n                          <span className=\"text-[11px] font-bold uppercase tracking-wider text-gray-400\">\n                            {step.details}\n                          </span>\n                        </div>\n                        <div\n                          className={`text-sm font-medium ${step.status === 'pending' ? 'text-gray-400' :\n                            step.status === 'error' ? 'text-red-600' :\n                              'text-slate-700'\n                            }`}\n                        >\n                          {step.message}\n                        </div>\n                      </div>\n                    </div>\n                  ))}\n\n                  {isAnalysisComplete && (\n                    <div className=\"mt-6 p-4 bg-green-50 border border-green-100 rounded-xl text-sm text-green-800 flex items-center gap-3 animate-in fade-in zoom-in-95 duration-500\">\n                      <div className=\"p-2 bg-green-100 rounded-full\">\n                        <CheckCircle2 size={20} />\n                      </div>\n                      <div>\n                        <div className=\"font-semibold\">Analysis Complete</div>\n                        <div className=\"text-green-700\">\n                          All compliance checks have finished. View results in the chat tab.\n                        </div>\n                      </div>\n                    </div>\n                  )}\n                </div>\n              )}\n\n              {activeTab === 'results' && (\n                <div className=\"space-y-6 animate-in fade-in duration-300 pb-4\">\n                  {messages.map((message, index) => (\n                    <div\n                      // biome-ignore lint/suspicious/noArrayIndexKey: Chat log is append-only\n                      key={index}\n                      className={`flex gap-4 ${message.role === 'user' ? 'justify-end' : ''}`}\n                    >\n                      {message.role === 'bot' && (\n                        <div className=\"w-8 h-8 rounded-full bg-indigo-50 border border-indigo-100 flex items-center justify-center shrink-0 p-1\">\n                          <Bot size={18} className=\"text-indigo-600\" />\n                        </div>\n                      )}\n\n                      <div\n                        className={`flex-1 max-w-xl ${message.role === 'user' ? 'flex justify-end' : ''\n                          }`}\n                      >\n                        <div\n                          className={`p-4 rounded-2xl text-slate-800 leading-relaxed text-sm shadow-sm ${message.role === 'bot'\n                            ? 'bg-white border border-gray-100 rounded-tl-none'\n                            : 'bg-blue-600 text-white rounded-br-none'\n                            }`}\n                        >\n                          {message.content}\n                        </div>\n                      </div>\n                    </div>\n                  ))}\n                  {isSending && (\n                    <div className=\"flex gap-4 animate-pulse\">\n                      <div className=\"w-8 h-8 rounded-full bg-indigo-50 border border-indigo-100 flex items-center justify-center shrink-0 p-1\">\n                        <Bot size={18} className=\"text-indigo-600\" />\n                      </div>\n                      <div className=\"flex-1\">\n                        <div className=\"bg-white border border-gray-100 p-4 rounded-2xl rounded-tl-none text-slate-800 leading-relaxed text-sm w-32 h-12 flex items-center\">\n                          <div className=\"flex gap-1\">\n                            <div\n                              className=\"w-2 h-2 bg-gray-300 rounded-full animate-bounce\"\n                              style={{ animationDelay: '0ms' }}\n                            ></div>\n                            <div\n                              className=\"w-2 h-2 bg-gray-300 rounded-full animate-bounce\"\n                              style={{ animationDelay: '150ms' }}\n                            ></div>\n                            <div\n                              className=\"w-2 h-2 bg-gray-300 rounded-full animate-bounce\"\n                              style={{ animationDelay: '300ms' }}\n                            ></div>\n                          </div>\n                        </div>\n                      </div>\n                    </div>\n                  )}\n                  <div ref={messagesEndRef} />\n                </div>\n              )}\n            </div>\n          )}\n        </div>\n      </div>\n\n      <div className=\"bg-white/80 backdrop-blur-md p-4 border-t border-gray-200 shrink-0 z-20\">\n        <div className=\"max-w-3xl mx-auto w-full\">\n          <div className=\"relative group\">\n            <Textarea\n              value={inputValue}\n              onChange={(e) => setInputValue(e.target.value)}\n              onKeyDown={(e) => {\n                if (e.key === 'Enter' && !e.shiftKey) {\n                  e.preventDefault();\n                  handleSendMessage();\n                }\n              }}\n              placeholder={\n                activeProject ? 'Ask follow-up questions...' : 'Upload a proposal to start analysis.'\n              }\n              className=\"w-full p-4 pr-14 text-sm resize-none bg-white min-h-[56px] shadow-sm border-gray-200 focus:border-blue-400 focus:ring-blue-100 rounded-xl transition-all\"\n              rows={1}\n              disabled={!activeProject || isSending}\n            />\n            <div className=\"absolute bottom-3 right-3\">\n              <Button\n                size=\"icon\"\n                className={`h-8 w-8 rounded-lg transition-all ${inputValue ? 'bg-blue-600 hover:bg-blue-700' : 'bg-gray-100 text-gray-400 hover:bg-gray-200'}`}\n                disabled={!inputValue || isSending || !activeProject}\n                onClick={handleSendMessage}\n              >\n                {isSending ? <Loader2 size={16} className=\"animate-spin\" /> : <Send size={16} />}\n              </Button>\n            </div>\n          </div>\n          <div className=\"text-center mt-2\">\n            <span className=\"text-[10px] text-gray-400 font-medium\">\n              AI can make mistakes. Review generated compliance reports.\n            </span>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default AgentInterface;\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 3548, "column": 0}, "map": {"version":3,"sources":["file:///Users/afos/Downloads/CtrlCheck-af-nonopen/proposal-prepper-web/src/components/layout/sidebar.tsx"],"sourcesContent":["'use client';\n\nimport { ChevronRight, Clock, FileText, History, MoreHorizontal, Plus, Star } from 'lucide-react';\nimport { useState } from 'react';\nimport { Button } from '@17sierra/ui';\n\ntype SidebarProps = {\n  activeProject: string | null;\n  setActiveProject: (id: string) => void;\n  resetDemo: () => void;\n  isOpen: boolean;\n};\n\nconst Sidebar = ({ activeProject, setActiveProject, resetDemo, isOpen }: SidebarProps) => {\n  const [activeTab, setActiveTab] = useState('all');\n\n  return (\n    <div\n      className={`bg-slate-50 border-gray-200 flex flex-col h-full shrink-0 transition-all duration-300 ease-in-out overflow-hidden shadow-inner ${isOpen ? 'w-[280px] border-r opacity-100' : 'w-0 border-r-0 opacity-0'\n        }`}\n    >\n      <div className=\"w-[280px] flex flex-col h-full\">\n        <div className=\"p-4 pt-5 pb-2\">\n          <Button\n            onClick={resetDemo}\n            className=\"w-full text-sm font-medium shadow-sm bg-indigo-600 hover:bg-indigo-700 text-white transition-colors h-10 gap-2\"\n          >\n            <Plus size={16} strokeWidth={2.5} />\n            New Compliance Check\n          </Button>\n        </div>\n\n        <div className=\"px-2 mt-2\">\n          <div className=\"flex p-1 bg-gray-200/50 rounded-lg mx-2 mb-2\">\n            <button\n              type=\"button\"\n              onClick={() => setActiveTab('all')}\n              className={`flex-1 flex items-center justify-center gap-1.5 py-1.5 text-xs font-semibold rounded-md transition-all ${activeTab === 'all'\n                ? 'bg-white text-slate-800 shadow-sm'\n                : 'text-gray-500 hover:text-slate-700 hover:bg-gray-200/50'\n                }`}\n            >\n              <History size={12} /> Recent\n            </button>\n            <button\n              type=\"button\"\n              onClick={() => setActiveTab('favorites')}\n              className={`flex-1 flex items-center justify-center gap-1.5 py-1.5 text-xs font-semibold rounded-md transition-all ${activeTab === 'favorites'\n                ? 'bg-white text-slate-800 shadow-sm'\n                : 'text-gray-500 hover:text-slate-700 hover:bg-gray-200/50'\n                }`}\n            >\n              <Star size={12} /> Saved\n            </button>\n          </div>\n        </div>\n\n        <div className=\"flex-1 overflow-y-auto px-4 py-2 custom-scrollbar\">\n          <div className=\"text-[10px] text-gray-400 font-bold mb-3 uppercase tracking-wider flex items-center gap-2\">\n            <Clock size={10} /> Today\n          </div>\n\n          {/* biome-ignore lint/a11y/useSemanticElements: Button nesting prevents using <button> tag */}\n          <div\n            role=\"button\"\n            tabIndex={0}\n            onClick={() => setActiveProject('proj-1')}\n            onKeyDown={(e) => {\n              if (e.key === 'Enter' || e.key === ' ') {\n                setActiveProject('proj-1');\n              }\n            }}\n            className={`w-full text-left p-3 rounded-xl border transition-all relative cursor-pointer ${activeProject === 'proj-1'\n              ? 'bg-blue-50/50 border-blue-200 shadow-sm'\n              : 'bg-white border-transparent hover:border-gray-200 hover:bg-gray-50'\n              }`}\n          >\n            <div className=\"flex items-start gap-3\">\n              <div\n                className={`p-2 rounded-md ${activeProject === 'proj-1' ? 'bg-blue-50 text-blue-600' : 'bg-gray-100 text-gray-500 hover:bg-blue-50 hover:text-blue-500'} transition-colors`}\n              >\n                <FileText size={18} />\n              </div>\n              <div className=\"flex-1 min-w-0\">\n                <div\n                  className={`font-medium text-sm truncate ${activeProject ? 'text-blue-700' : 'text-slate-700'}`}\n                >\n                  SaaS Proposal - DOE\n                </div>\n                <div className=\"text-[11px] text-gray-400 mt-1 flex justify-between items-center font-medium\">\n                  <span>10:23 AM</span>\n                  <span className=\"flex items-center gap-1 text-slate-400\">\n                    92% <span className=\"w-1.5 h-1.5 rounded-full bg-green-500 inline-block\"></span>\n                  </span>\n                </div>\n              </div>\n            </div>\n\n            <Button\n              variant=\"ghost\"\n              size=\"icon\"\n              className=\"absolute right-2 top-2 h-6 w-6 opacity-0 group-hover:opacity-100 transition-opacity\"\n            >\n              <MoreHorizontal size={14} className=\"text-gray-400\" />\n            </Button>\n\n            {activeProject && (\n              <div className=\"absolute right-0 top-1/2 -translate-y-1/2 translate-x-1/2 bg-white rounded-full border border-blue-200 p-0.5 text-blue-600 shadow-sm z-10 w-5 h-5 flex items-center justify-center\">\n                <ChevronRight size={12} />\n              </div>\n            )}\n          </div>\n        </div>\n\n        {/* User Profile / Config Section at bottom */}\n        <div className=\"p-3 border-t border-gray-200 bg-slate-50\">\n          <div className=\"text-[10px] text-center text-gray-300 font-mono\">v2.1.0-mesh</div>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default Sidebar;\n"],"names":[],"mappings":";;;;;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AAJA;;;;;AAaA,MAAM,UAAU,CAAC,EAAE,aAAa,EAAE,gBAAgB,EAAE,SAAS,EAAE,MAAM,EAAgB;IACnF,MAAM,CAAC,WAAW,aAAa,GAAG,IAAA,8bAAQ,EAAC;IAE3C,qBACE,2dAAC;QACC,WAAW,CAAC,+HAA+H,EAAE,SAAS,mCAAmC,4BACrL;kBAEJ,cAAA,2dAAC;YAAI,WAAU;;8BACb,2dAAC;oBAAI,WAAU;8BACb,cAAA,2dAAC,6ZAAM;wBACL,SAAS;wBACT,WAAU;;0CAEV,2dAAC,4TAAI;gCAAC,MAAM;gCAAI,aAAa;;;;;;4BAAO;;;;;;;;;;;;8BAKxC,2dAAC;oBAAI,WAAU;8BACb,cAAA,2dAAC;wBAAI,WAAU;;0CACb,2dAAC;gCACC,MAAK;gCACL,SAAS,IAAM,aAAa;gCAC5B,WAAW,CAAC,uGAAuG,EAAE,cAAc,QAC/H,sCACA,2DACA;;kDAEJ,2dAAC,qUAAO;wCAAC,MAAM;;;;;;oCAAM;;;;;;;0CAEvB,2dAAC;gCACC,MAAK;gCACL,SAAS,IAAM,aAAa;gCAC5B,WAAW,CAAC,uGAAuG,EAAE,cAAc,cAC/H,sCACA,2DACA;;kDAEJ,2dAAC,4TAAI;wCAAC,MAAM;;;;;;oCAAM;;;;;;;;;;;;;;;;;;8BAKxB,2dAAC;oBAAI,WAAU;;sCACb,2dAAC;4BAAI,WAAU;;8CACb,2dAAC,+TAAK;oCAAC,MAAM;;;;;;gCAAM;;;;;;;sCAIrB,2dAAC;4BACC,MAAK;4BACL,UAAU;4BACV,SAAS,IAAM,iBAAiB;4BAChC,WAAW,CAAC;gCACV,IAAI,EAAE,GAAG,KAAK,WAAW,EAAE,GAAG,KAAK,KAAK;oCACtC,iBAAiB;gCACnB;4BACF;4BACA,WAAW,CAAC,8EAA8E,EAAE,kBAAkB,WAC1G,4CACA,sEACA;;8CAEJ,2dAAC;oCAAI,WAAU;;sDACb,2dAAC;4CACC,WAAW,CAAC,eAAe,EAAE,kBAAkB,WAAW,6BAA6B,iEAAiE,kBAAkB,CAAC;sDAE3K,cAAA,2dAAC,4UAAQ;gDAAC,MAAM;;;;;;;;;;;sDAElB,2dAAC;4CAAI,WAAU;;8DACb,2dAAC;oDACC,WAAW,CAAC,6BAA6B,EAAE,gBAAgB,kBAAkB,kBAAkB;8DAChG;;;;;;8DAGD,2dAAC;oDAAI,WAAU;;sEACb,2dAAC;sEAAK;;;;;;sEACN,2dAAC;4DAAK,WAAU;;gEAAyC;8EACnD,2dAAC;oEAAK,WAAU;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;8CAM5B,2dAAC,6ZAAM;oCACL,SAAQ;oCACR,MAAK;oCACL,WAAU;8CAEV,cAAA,2dAAC,oVAAc;wCAAC,MAAM;wCAAI,WAAU;;;;;;;;;;;gCAGrC,+BACC,2dAAC;oCAAI,WAAU;8CACb,cAAA,2dAAC,wVAAY;wCAAC,MAAM;;;;;;;;;;;;;;;;;;;;;;;8BAO5B,2dAAC;oBAAI,WAAU;8BACb,cAAA,2dAAC;wBAAI,WAAU;kCAAkD;;;;;;;;;;;;;;;;;;;;;;AAK3E;uCAEe"}},
    {"offset": {"line": 3833, "column": 0}, "map": {"version":3,"sources":["file:///Users/afos/Downloads/CtrlCheck-af-nonopen/proposal-prepper-web/src/components/layout/top-bar.tsx"],"sourcesContent":["'use client';\n\nimport { Bell, Bot, HelpCircle, PanelLeftClose, PanelLeftOpen, Settings } from 'lucide-react';\nimport { Avatar, AvatarFallback, Button } from '@/components/ui';\n\ntype TopBarProps = {\n  toggleSidebar: () => void;\n  isSidebarOpen: boolean;\n};\n\nconst TopBar = ({ toggleSidebar, isSidebarOpen }: TopBarProps) => {\n  return (\n    <div className=\"bg-white border-b border-gray-200 h-16 flex items-center px-4 justify-between shadow-sm z-20 relative\">\n      <div className=\"flex items-center gap-4 text-slate-800 font-semibold text-lg\">\n        <Button\n          variant=\"ghost\"\n          size=\"icon\"\n          onClick={toggleSidebar}\n          className=\"h-9 w-9 text-slate-500 hover:text-primary hover:bg-primary/5 transition-colors\"\n          title={isSidebarOpen ? 'Close Sidebar' : 'Open Sidebar'}\n        >\n          {isSidebarOpen ? <PanelLeftClose size={20} /> : <PanelLeftOpen size={20} />}\n        </Button>\n\n        <div className=\"flex items-center gap-3\">\n          <div className=\"bg-indigo-600 text-white p-1.5 rounded-lg shadow-sm shadow-indigo-200\">\n            <Bot size={20} />\n          </div>\n          <div className=\"leading-tight\">\n            <div className=\"flex items-center gap-2\">\n              ATARC Agentic AI Lab\n              <span className=\"bg-amber-100 text-amber-700 text-[10px] px-2 py-0.5 rounded-full border border-amber-200 uppercase font-bold tracking-wider\">\n                Alpha\n              </span>\n            </div>\n            <div className=\"text-[10px] text-gray-400 font-normal tracking-wide\">\n              PROPOSAL PREPPER WORKSPACE\n            </div>\n          </div>\n        </div>\n      </div>\n\n      <div className=\"flex items-center gap-2\">\n        <Button variant=\"ghost\" size=\"icon\" className=\"h-9 w-9 text-slate-400 hover:text-slate-600\">\n          <HelpCircle size={18} />\n        </Button>\n        <Button\n          variant=\"ghost\"\n          size=\"icon\"\n          className=\"h-9 w-9 text-slate-400 hover:text-slate-600 relative\"\n        >\n          <Bell size={18} />\n          <span className=\"absolute top-2 right-2 w-2 h-2 bg-red-500 rounded-full border border-white\"></span>\n        </Button>\n        <div className=\"w-px h-6 bg-gray-200 mx-1\"></div>\n        <Button variant=\"ghost\" size=\"icon\" className=\"h-9 w-9 text-slate-400 hover:text-slate-600\">\n          <Settings size={18} />\n        </Button>\n        <Avatar className=\"h-9 w-9 text-xs border border-gray-100 shadow-sm cursor-pointer hover:ring-2 hover:ring-indigo-100 transition-all\">\n          <AvatarFallback className=\"bg-indigo-50 text-indigo-700 font-bold\">AF</AvatarFallback>\n        </Avatar>\n      </div>\n    </div>\n  );\n};\n\nexport default TopBar;\n"],"names":[],"mappings":";;;;;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAHA;;;;AAUA,MAAM,SAAS,CAAC,EAAE,aAAa,EAAE,aAAa,EAAe;IAC3D,qBACE,2dAAC;QAAI,WAAU;;0BACb,2dAAC;gBAAI,WAAU;;kCACb,2dAAC,6ZAAM;wBACL,SAAQ;wBACR,MAAK;wBACL,SAAS;wBACT,WAAU;wBACV,OAAO,gBAAgB,kBAAkB;kCAExC,8BAAgB,2dAAC,kWAAc;4BAAC,MAAM;;;;;qFAAS,2dAAC,+VAAa;4BAAC,MAAM;;;;;;;;;;;kCAGvE,2dAAC;wBAAI,WAAU;;0CACb,2dAAC;gCAAI,WAAU;0CACb,cAAA,2dAAC,yTAAG;oCAAC,MAAM;;;;;;;;;;;0CAEb,2dAAC;gCAAI,WAAU;;kDACb,2dAAC;wCAAI,WAAU;;4CAA0B;0DAEvC,2dAAC;gDAAK,WAAU;0DAA8H;;;;;;;;;;;;kDAIhJ,2dAAC;wCAAI,WAAU;kDAAsD;;;;;;;;;;;;;;;;;;;;;;;;0BAO3E,2dAAC;gBAAI,WAAU;;kCACb,2dAAC,6ZAAM;wBAAC,SAAQ;wBAAQ,MAAK;wBAAO,WAAU;kCAC5C,cAAA,2dAAC,8VAAU;4BAAC,MAAM;;;;;;;;;;;kCAEpB,2dAAC,6ZAAM;wBACL,SAAQ;wBACR,MAAK;wBACL,WAAU;;0CAEV,2dAAC,4TAAI;gCAAC,MAAM;;;;;;0CACZ,2dAAC;gCAAK,WAAU;;;;;;;;;;;;kCAElB,2dAAC;wBAAI,WAAU;;;;;;kCACf,2dAAC,6ZAAM;wBAAC,SAAQ;wBAAQ,MAAK;wBAAO,WAAU;kCAC5C,cAAA,2dAAC,wUAAQ;4BAAC,MAAM;;;;;;;;;;;kCAElB,2dAAC,6ZAAM;wBAAC,WAAU;kCAChB,cAAA,2dAAC,qaAAc;4BAAC,WAAU;sCAAyC;;;;;;;;;;;;;;;;;;;;;;;AAK7E;uCAEe"}},
    {"offset": {"line": 4045, "column": 0}, "map": {"version":3,"sources":["file:///Users/afos/Downloads/CtrlCheck-af-nonopen/proposal-prepper-web/src/components/report-preview.tsx"],"sourcesContent":["'use client';\n\nimport { AlertTriangle, Calendar, CheckCircle2, Download, FileText, Maximize2 } from 'lucide-react';\nimport { Badge, Button } from '@17sierra/ui';\nimport type { AnalysisResults, ComplianceIssue } from '@/components/results/types';\n\ntype ReportPreviewProps = {\n  isVisible: boolean;\n  results?: AnalysisResults | null;\n};\n\nconst ReportPreview = ({ isVisible, results }: ReportPreviewProps) => {\n  if (!isVisible) return null;\n\n  // Use results if available, otherwise fallback (or show nothing/loading if needed)\n  if (!results) return null;\n\n  return (\n    <div className=\"flex-1 bg-slate-50 border-l border-gray-200 h-full flex flex-col animate-in slide-in-from-right duration-500 z-10 shadow-xl max-w-[50%] min-w-[500px]\">\n      <div className=\"h-16 bg-white border-b border-gray-200 flex items-center justify-between px-6 shrink-0 z-20 shadow-sm\">\n        <div className=\"flex items-center gap-2\">\n          <FileText size={18} className=\"text-blue-600\" />\n          <div className=\"font-semibold text-slate-800 text-sm\">Compliance Report Preview</div>\n        </div>\n        <div className=\"flex gap-2\">\n          <Button variant=\"outline\" size=\"sm\" className=\"h-8 text-xs gap-1.5 hidden md:flex\">\n            <Maximize2 size={12} /> Fullscreen\n          </Button>\n          <Button size=\"sm\" className=\"h-8 text-xs gap-1.5 bg-slate-900 hover:bg-slate-800\">\n            <Download size={12} /> Download PDF\n          </Button>\n        </div>\n      </div>\n\n      <div className=\"flex-1 p-6 md:p-8 overflow-y-auto bg-gray-50/50\">\n        <div className=\"bg-white shadow-lg rounded-sm w-full max-w-[800px] mx-auto p-10 md:p-14 relative ring-1 ring-gray-900/5\">\n          {/* Document Header */}\n          <div className=\"flex justify-between items-start mb-10 border-b-2 border-slate-900 pb-6\">\n            <div>\n              <h1 className=\"text-3xl font-bold text-slate-900 mb-2 tracking-tight\">\n                Compliance Validation Report\n              </h1>\n              <p className=\"text-gray-500 text-sm font-medium\">\n                Generated by ATARC Compliance Agent\n              </p>\n            </div>\n            <div className=\"text-right\">\n              <div className=\"text-sm font-bold text-slate-900 bg-slate-100 px-3 py-1 rounded-md inline-block mb-1\">\n                Ref: PROP-2024-001\n              </div>\n              <div className=\"text-sm text-gray-500 flex items-center justify-end gap-1.5\">\n                <Calendar size={12} /> {new Date().toLocaleDateString('en-US', { month: 'short', day: '2-digit', year: 'numeric' })}\n              </div>\n            </div>\n          </div>\n\n          {/* Executive Summary Section */}\n          <div className=\"mb-10\">\n            <div className=\"flex items-center gap-3 mb-4\">\n              <div className=\"h-8 w-1 bg-blue-600 rounded-full\"></div>\n              <h3 className=\"font-bold text-slate-800 uppercase tracking-wider text-sm\">\n                Executive Summary\n              </h3>\n            </div>\n            <p className=\"text-sm text-gray-600 leading-relaxed mb-6 font-serif text-justify\">\n              The submitted proposal has been analyzed against the current Federal Acquisition Regulation (FAR)\n              and Defense Federal Acquisition Regulation Supplement (DFARS). The document scored a{' '}\n              <span className={`px-1 py-0.5 rounded font-bold ${results.overallScore >= 90 ? 'bg-green-100 text-green-800' :\n                  results.overallScore >= 70 ? 'bg-yellow-100 text-yellow-800' : 'bg-red-100 text-red-800'\n                }`}>\n                {results.overallScore}% compliance rating\n              </span>\n              .\n            </p>\n\n            <div className={`border rounded-lg p-5 flex gap-4 items-start shadow-sm ${results.status === 'pass' ? 'bg-green-50 border-green-200' :\n                results.status === 'warning' ? 'bg-yellow-50 border-yellow-200' : 'bg-red-50 border-red-200'\n              }`}>\n              <div className={`p-2 rounded-full shrink-0 ${results.status === 'pass' ? 'bg-green-100' :\n                  results.status === 'warning' ? 'bg-yellow-100' : 'bg-red-100'\n                }`}>\n                {results.status === 'pass' ? (\n                  <CheckCircle2 size={24} className=\"text-green-600\" />\n                ) : (\n                  <AlertTriangle size={24} className={results.status === 'warning' ? 'text-yellow-600' : 'text-red-600'} />\n                )}\n              </div>\n              <div>\n                <strong className={`block mb-1 text-base ${results.status === 'pass' ? 'text-green-900' :\n                    results.status === 'warning' ? 'text-yellow-900' : 'text-red-900'\n                  }`}>\n                  Status: {results.status.toUpperCase()}\n                </strong>\n                <div className={`text-sm leading-relaxed ${results.status === 'pass' ? 'text-green-800' :\n                    results.status === 'warning' ? 'text-yellow-800' : 'text-red-800'\n                  }`}>\n                  {results.status === 'pass'\n                    ? 'This proposal meets all mandatory formatting and inclusion requirements for the targeted solicitation. No critical blocking issues were found.'\n                    : `This proposal has identified ${results.status === 'warning' ? 'warnings' : 'critical issues'} that require attention.`}\n                </div>\n              </div>\n            </div>\n          </div>\n\n          {/* Key Findings Section */}\n          <div className=\"mb-8\">\n            <div className=\"flex items-center gap-3 mb-5\">\n              <div className=\"h-8 w-1 bg-slate-800 rounded-full\"></div>\n              <h3 className=\"font-bold text-slate-800 uppercase tracking-wider text-sm\">\n                Detailed Findings\n              </h3>\n            </div>\n\n            <div className=\"space-y-4\">\n              {results.issues.length === 0 ? (\n                <div className=\"text-center p-8 text-gray-500 italic\">No issues found.</div>\n              ) : (\n                results.issues.map((issue) => (\n                  <div\n                    key={issue.id}\n                    className={`group border rounded-lg p-4 hover:shadow-md transition-all ${issue.severity === 'critical' ? 'border-red-200 bg-red-50/30' :\n                        issue.severity === 'warning' ? 'border-yellow-200 bg-yellow-50/30' : 'border-gray-200 bg-white hover:border-blue-300'\n                      }`}\n                  >\n                    <div className=\"flex justify-between items-center mb-2\">\n                      <div className=\"flex items-center gap-2\">\n                        {issue.regulation && (\n                          <span className=\"bg-gray-100 text-gray-600 text-[10px] font-mono px-1.5 py-0.5 rounded border border-gray-200\">\n                            {issue.regulation}\n                          </span>\n                        )}\n                        <span className=\"font-semibold text-sm text-slate-800\">\n                          {issue.title}\n                        </span>\n                      </div>\n                      <Badge\n                        variant=\"secondary\"\n                        className={`font-bold ${issue.severity === 'critical' ? 'bg-red-100 text-red-700 border-red-200' :\n                            issue.severity === 'warning' ? 'bg-yellow-100 text-yellow-800 border-yellow-200' : 'bg-blue-100 text-blue-700 border-blue-200'\n                          }`}\n                      >\n                        {issue.severity.toUpperCase()}\n                      </Badge>\n                    </div>\n\n                    <div className={`gap-2 items-start pl-1 border-l-2 ml-1 ${issue.severity === 'critical' ? 'border-red-300' :\n                        issue.severity === 'warning' ? 'border-yellow-300' : 'border-gray-200'\n                      }`}>\n                      <p className=\"text-xs text-gray-600 mb-1\">{issue.description}</p>\n                      {issue.remediation && (\n                        <p className=\"text-xs text-slate-500 italic mt-1 bg-white/50 p-1.5 rounded\">\n                          Recommendation: {issue.remediation}\n                        </p>\n                      )}\n                    </div>\n                  </div>\n                ))\n              )}\n            </div>\n          </div>\n\n          <div className=\"mt-12 text-center border-t border-gray-100 pt-8 text-[10px] text-gray-400 uppercase tracking-widest\">\n            CONFIDENTIAL - PROPRIETARY INFORMATION - DO NOT DISTRIBUTE\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default ReportPreview;\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 4497, "column": 0}, "map": {"version":3,"sources":["file:///Users/afos/Downloads/CtrlCheck-af-nonopen/proposal-prepper-web/src/app/page.tsx"],"sourcesContent":["'use client';\n\nimport { useCallback, useState } from 'react';\nimport AgentInterface from '@/components/agent-interface';\nimport Sidebar from '@/components/layout/sidebar';\nimport TopBar from '@/components/layout/top-bar';\nimport ReportPreview from '@/components/report-preview';\nimport type { AnalysisResults } from '@/components/results/types';\n\nexport default function App() {\n  const [activeProject, setActiveProject] = useState<string | null>(null);\n  const [showReport, setShowReport] = useState(false);\n  const [isSidebarOpen, setSidebarOpen] = useState(true);\n  const [analysisResults, setAnalysisResults] = useState<AnalysisResults | null>(null);\n\n  // Called when analysis starts (file selected and upload begins)\n  const handleAnalysisStart = useCallback(() => {\n    setActiveProject('analyzing');\n    setShowReport(false);\n    setAnalysisResults(null);\n  }, []);\n\n  // Called when analysis completes successfully with results\n  const handleAnalysisComplete = useCallback((results: AnalysisResults) => {\n    setAnalysisResults(results);\n    setShowReport(true);\n  }, []);\n\n  // Called when analysis fails\n  const handleAnalysisError = useCallback((error: string) => {\n    console.error('Analysis failed:', error);\n    // Keep activeProject set so user can see the error state\n  }, []);\n\n  const resetDemo = useCallback(() => {\n    setActiveProject(null);\n    setShowReport(false);\n    setAnalysisResults(null);\n    if (!isSidebarOpen) {\n      setSidebarOpen(true);\n    }\n  }, [isSidebarOpen]);\n\n  return (\n    <div className=\"h-screen bg-background flex flex-col font-body text-slate-800 overflow-hidden\">\n      <TopBar toggleSidebar={() => setSidebarOpen(!isSidebarOpen)} isSidebarOpen={isSidebarOpen} />\n\n      <div className=\"flex flex-1 overflow-hidden h-[calc(100vh-64px)]\">\n        <Sidebar\n          activeProject={activeProject}\n          setActiveProject={setActiveProject}\n          resetDemo={resetDemo}\n          isOpen={isSidebarOpen}\n        />\n\n        <main className=\"flex-1 flex relative bg-white shadow-inner-xl m-0 md:my-2 md:mr-2 md:rounded-lg overflow-hidden border-t md:border border-gray-200/80 transition-all duration-300\">\n          <AgentInterface\n            activeProject={activeProject}\n            onAnalysisStart={handleAnalysisStart}\n            onAnalysisComplete={handleAnalysisComplete}\n            onAnalysisError={handleAnalysisError}\n          />\n          <ReportPreview isVisible={showReport} results={analysisResults} />\n        </main>\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AACA;AACA;AANA;;;;;;;AASe,SAAS;IACtB,MAAM,CAAC,eAAe,iBAAiB,GAAG,IAAA,8bAAQ,EAAgB;IAClE,MAAM,CAAC,YAAY,cAAc,GAAG,IAAA,8bAAQ,EAAC;IAC7C,MAAM,CAAC,eAAe,eAAe,GAAG,IAAA,8bAAQ,EAAC;IACjD,MAAM,CAAC,iBAAiB,mBAAmB,GAAG,IAAA,8bAAQ,EAAyB;IAE/E,gEAAgE;IAChE,MAAM,sBAAsB,IAAA,icAAW,EAAC;QACtC,iBAAiB;QACjB,cAAc;QACd,mBAAmB;IACrB,GAAG,EAAE;IAEL,2DAA2D;IAC3D,MAAM,yBAAyB,IAAA,icAAW,EAAC,CAAC;QAC1C,mBAAmB;QACnB,cAAc;IAChB,GAAG,EAAE;IAEL,6BAA6B;IAC7B,MAAM,sBAAsB,IAAA,icAAW,EAAC,CAAC;QACvC,QAAQ,KAAK,CAAC,oBAAoB;IAClC,yDAAyD;IAC3D,GAAG,EAAE;IAEL,MAAM,YAAY,IAAA,icAAW,EAAC;QAC5B,iBAAiB;QACjB,cAAc;QACd,mBAAmB;QACnB,IAAI,CAAC,eAAe;YAClB,eAAe;QACjB;IACF,GAAG;QAAC;KAAc;IAElB,qBACE,2dAAC;QAAI,WAAU;;0BACb,2dAAC,mLAAM;gBAAC,eAAe,IAAM,eAAe,CAAC;gBAAgB,eAAe;;;;;;0BAE5E,2dAAC;gBAAI,WAAU;;kCACb,2dAAC,gLAAO;wBACN,eAAe;wBACf,kBAAkB;wBAClB,WAAW;wBACX,QAAQ;;;;;;kCAGV,2dAAC;wBAAK,WAAU;;0CACd,2dAAC,iLAAc;gCACb,eAAe;gCACf,iBAAiB;gCACjB,oBAAoB;gCACpB,iBAAiB;;;;;;0CAEnB,2dAAC,gLAAa;gCAAC,WAAW;gCAAY,SAAS;;;;;;;;;;;;;;;;;;;;;;;;AAKzD"}}]
}